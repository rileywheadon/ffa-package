<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Trend Identification (Variability) • ffaframework</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trend Identification (Variability)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ffaframework</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/trend-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/trend-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/stationary-ffa.html">Stationary FFA</a></li>
    <li><a class="dropdown-item" href="../articles/non-stationary-ffa.html">Nonstationary FFA</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/wrapper-functions.html">Using Wrapper Functions</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-wiki" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Wiki</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-wiki">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/eda-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eda-change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/ffa-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-probability-distributions.html">Probability Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-uncertainty-quantification.html">Uncertainty Quantification</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-assessment.html">Model Assessment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/matlab-version.html">MATLAB Version</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rileywheadon/ffa-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Trend Identification (Variability)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rileywheadon/ffa-package/blob/master/vignettes/trend-variability.Rmd" class="external-link"><code>vignettes/trend-variability.Rmd</code></a></small>
      <div class="d-none name"><code>trend-variability.Rmd</code></div>
    </div>

    
    
<p>Many factors can produce <em>nonstationarity</em> in annual maximum
series (AMS) data, including changes in climate, land use/cover, and
water management. This vignette demonstrates how to use the
<code>ffaframework</code> to check for evidence of nonstationarity in
the <em>variability</em> of a time series.</p>
<div class="section level2">
<h2 id="list-of-tests">List of Tests<a class="anchor" aria-label="anchor" href="#list-of-tests"></a>
</h2>
<p><strong>Mean Trend Tests</strong></p>
<table class="table">
<colgroup>
<col width="25%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>eda_mk_test</code></td>
<td>Tests for a monotonic trend (Mann-Kendall test).</td>
</tr>
<tr class="even">
<td><code>eda_bbmk_test</code></td>
<td>Tests for a monotonic trend under serial correlation (BBMK
test).</td>
</tr>
</tbody>
</table>
<p><strong>Stationarity Tests</strong></p>
<table class="table">
<colgroup>
<col width="25%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>eda_spearman_test</code></td>
<td>Tests for serial correlation (Spearman test).</td>
</tr>
<tr class="even">
<td><code>eda_kpss_test</code></td>
<td>Tests for a stochastic trend (KPSS test).</td>
</tr>
<tr class="odd">
<td><code>eda_pp_test</code></td>
<td>Tests for a deterministic trend (Phillips-Perron test).</td>
</tr>
</tbody>
</table>
<p><strong>Variability Trend Tests</strong></p>
<table class="table">
<colgroup>
<col width="25%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>MW-MK Test</td>
<td>Tests for a trend in the variability (MWMK test)</td>
</tr>
<tr class="even">
<td><code>eda_white_test</code></td>
<td>Tests for time-dependence in the variability (White test).</td>
</tr>
</tbody>
</table>
<p><strong>Trend Estimation (Mean &amp; Variability)</strong></p>
<table class="table">
<colgroup>
<col width="25%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>eda_sens_trend</code></td>
<td>Estimates slope and intercept of a linear trend (Sen’s trend
estimator).</td>
</tr>
<tr class="even">
<td><code>eda_runs_test</code></td>
<td>Evaluates residuals’ structure under linear model assumptions (runs
test).</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="case-study">Case Study<a class="anchor" aria-label="anchor" href="#case-study"></a>
</h2>
<p>This vignette will explore data from the Chilliwack River at
Chilliwack Lake (08MH016) hydrological monitoring station. The
remoteness of this station means that trends annual maxima are caused by
changes in climate as opposed to changes in land use or cover. Data for
this station is provided as <code>CAN-08MH016.csv</code> in the
<code>ffaframework</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rileywheadon.github.io/ffa-package/">ffaframework</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_local.html">data_local</a></span><span class="op">(</span><span class="st">"CAN-08MH016.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year  max</span></span>
<span><span class="co">#&gt; 1 1922 62.9</span></span>
<span><span class="co">#&gt; 2 1923 74.5</span></span>
<span><span class="co">#&gt; 3 1924 79.0</span></span>
<span><span class="co">#&gt; 4 1925 35.1</span></span>
<span><span class="co">#&gt; 5 1926 62.3</span></span>
<span><span class="co">#&gt; 6 1927 65.7</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_ams_data.html">plot_ams_data</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="va">df</span><span class="op">$</span><span class="va">year</span>, title <span class="op">=</span> <span class="st">"Chilliwack River at Chilliwack Lake (08MH016)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="trend-variability_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="assessing-trends-in-the-variance">Assessing Trends in the Variance<a class="anchor" aria-label="anchor" href="#assessing-trends-in-the-variance"></a>
</h2>
<div class="section level3">
<h3 id="mwmk-test">MWMK Test<a class="anchor" aria-label="anchor" href="#mwmk-test"></a>
</h3>
<p>The MWMK test is used to detect trends in the variability of a time
series. First, a moving-window algorithm is used to estimate the
variability of the AMS data. Then, the Mann-Kendall test is applied to
the series of standard deviations to check for a trend.</p>
<p>The <code>data_mw_variability</code> estimates the moving-window
standard deviations and the <code>eda_mk_test</code> function performs
the Mann-Kendall test.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_mw_variability.html">data_mw_variability</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="va">mwmk_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_mk_test.html">eda_mk_test</a></span><span class="op">(</span><span class="va">mw</span><span class="op">$</span><span class="va">std</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mwmk_test</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001463998</span></span></code></pre></div>
<p><strong>Conclusion</strong>: At a p-value of <span class="math inline">\(0.0015\)</span>, we <em>reject</em> the null
hypothesis. There is evidence of a linear trend in the variability in
the data.</p>
</div>
<div class="section level3">
<h3 id="white-test">White Test<a class="anchor" aria-label="anchor" href="#white-test"></a>
</h3>
<p>The White test checks for <em>heteroskedasticity</em>, or general
time-dependence in the variability. The null hypothesis is
<em>homoskedasticity</em>, or constant variability in the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">white_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_white_test.html">eda_white_test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">white_test</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1175955</span></span></code></pre></div>
<p><strong>Conclusion</strong>: At a p-value of <span class="math inline">\(0.1176\)</span>, we <em>fail to reject</em> the
null hypothesis. There is no statistical evidence of
heteroskedasticity.</p>
</div>
<div class="section level3">
<h3 id="sens-trend-estimator">Sen’s Trend Estimator<a class="anchor" aria-label="anchor" href="#sens-trend-estimator"></a>
</h3>
<p>While the previous tests provide evidence for a monotonic trend in
the variability, they do not estimate the slope or intercept of this
trend. We can estimate the monotonic trend using Sen’s trend estimator,
which uses a nonparametric approach that is robust to outliers.</p>
<p><code><a href="../reference/eda_sens_trend.html">eda_sens_trend()</a></code> takes two arguments: the data (either
an annual maximum series or vector of standard deviations) and the
corresponding vector of years. Alternatively,
<code><a href="../reference/plot_ams_data.html">plot_ams_data()</a></code> can be used to run Sen’s trend estimator on
the data and/or variability series and then plot the results. It takes
the optional arguments <code>plot_mean</code> and
<code>plot_variability</code> in addition to the <code>data</code> and
<code>years</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ams_data.html">plot_ams_data</a></span><span class="op">(</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">max</span>,</span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">year</span>,</span>
<span>    plot_mean <span class="op">=</span> <span class="st">"Constant"</span>,</span>
<span>    plot_variability <span class="op">=</span> <span class="st">"Trend"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Sen's Trend Estimator (AMS Variability)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="trend-variability_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><strong>Note</strong>: The covariate is computed using the formula
<span class="math inline">\((\text{years} - 1900) / 100\)</span>.</p>
</div>
<div class="section level3">
<h3 id="runs-test">Runs Test<a class="anchor" aria-label="anchor" href="#runs-test"></a>
</h3>
<p>Sen’s trend estimator assumed that the nonstationarity is linear. The
runs test assess the feasibility of the linearity assumption by checking
the residuals for randomness. If the residuals are random (the null
hypothesis), there is evidence that the underlying trend is linear. The
<code><a href="../reference/eda_runs_test.html">eda_runs_test()</a></code> function takes the residuals from
<code><a href="../reference/eda_sens_trend.html">eda_sens_trend()</a></code> as the first argument and the observation
years as the second argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens_trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_sens_trend.html">eda_sens_trend</a></span><span class="op">(</span><span class="va">mw</span><span class="op">$</span><span class="va">std</span>, <span class="va">mw</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span></span>
<span><span class="va">runs_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eda_runs_test.html">eda_runs_test</a></span><span class="op">(</span><span class="va">sens_trend</span><span class="op">$</span><span class="va">residuals</span>, <span class="va">mw</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">runs_test</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3311375</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_runs_test.html">plot_runs_test</a></span><span class="op">(</span><span class="va">runs_test</span>, title <span class="op">=</span> <span class="st">"Runs Test (AMS Variability)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="trend-variability_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><strong>Conclusion</strong>: At a p-value of <span class="math inline">\(0.3311\)</span>, we <em>fail to reject</em> the
null hypothesis. There is evidence that the residuals are random and a
linear trend is suitable for the data.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The MWMK and White tests find <em>evidence of nonstationarity in the
variability of the AMS</em>. The runs test confirms that a <em>linear
model is suitable for the nonstationarity</em>. Flood frequency analysis
of this dataset requires a time-dependent probability model.</p>
<p><strong>Recommendation</strong>: Use NS-FFA.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riley Wheadon, Cuauhtémoc Vidrio-Sahagún, Alain Pietroniro, Jianxun He, Environment and Climate Change Canada (ECCC).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
