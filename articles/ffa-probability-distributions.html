<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> â€¢ ffaframework</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ffaframework</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/trend-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/trend-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/stationary-ffa.html">Stationary FFA</a></li>
    <li><a class="dropdown-item" href="../articles/non-stationary-ffa.html">Nonstationary FFA</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/wrapper-functions.html">Using Wrapper Functions</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-wiki" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Wiki</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-wiki">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/eda-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eda-change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/ffa-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-probability-distributions.html">Probability Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-uncertainty-quantification.html">Uncertainty Quantification</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-assessment.html">Model Assessment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/matlab-version.html">MATLAB Version</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rileywheadon/ffa-framework/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rileywheadon/ffa-framework/blob/master/vignettes/articles/ffa-probability-distributions.Rmd" class="external-link"><code>vignettes/articles/ffa-probability-distributions.Rmd</code></a></small>
      <div class="d-none name"><code>ffa-probability-distributions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="candidate-probability-distributions">Candidate Probability Distributions<a class="anchor" aria-label="anchor" href="#candidate-probability-distributions"></a>
</h2>
<p>The FFA framework considers nine candidate probability
distributions:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="28%">
<col width="13%">
<col width="57%">
</colgroup>
<thead><tr class="header">
<th>Distribution</th>
<th>Abbreviation</th>
<th>Parameters</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gumbel</td>
<td><code>GUM</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale)</td>
</tr>
<tr class="even">
<td>Normal</td>
<td><code>NOR</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale)</td>
</tr>
<tr class="odd">
<td>Log-Normal</td>
<td><code>LNO</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale)</td>
</tr>
<tr class="even">
<td>Generalized Extreme Value</td>
<td><code>GEV</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale), <span class="math inline">\(\kappa\)</span> (shape)</td>
</tr>
<tr class="odd">
<td>Generalized Logistic Value</td>
<td><code>GLO</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale), <span class="math inline">\(\kappa\)</span> (shape)</td>
</tr>
<tr class="even">
<td>Generalized Normal</td>
<td><code>GNO</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale), <span class="math inline">\(\kappa\)</span> (shape)</td>
</tr>
<tr class="odd">
<td>Pearson Type III</td>
<td><code>PE3</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale), <span class="math inline">\(\kappa\)</span> (shape)</td>
</tr>
<tr class="even">
<td>Log-Pearson Type III</td>
<td><code>LP3</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale), <span class="math inline">\(\kappa\)</span> (shape)</td>
</tr>
<tr class="odd">
<td>Weibull</td>
<td><code>WEI</code></td>
<td>
<span class="math inline">\(\mu\)</span> (location), <span class="math inline">\(\sigma\)</span> (scale), <span class="math inline">\(\kappa\)</span> (shape)</td>
</tr>
</tbody>
</table>
<p>Each distribution also has three nonstationary variants:</p>
<ol style="list-style-type: decimal">
<li>A trend in the location parameter <span class="math inline">\(\mu\)</span> (+1 parameter).</li>
<li>A trend in the scale parameter <span class="math inline">\(\sigma\)</span> (+1 parameter).</li>
<li>A trend in the location <span class="math inline">\(\mu\)</span> and
the scale <span class="math inline">\(\sigma\)</span> (+2
parameters).</li>
</ol>
<p>The FFA framework also uses the four-parameter Kappa distribution
(KAP) for the <a href="model-selection.html#3-z-statistic">Z-statistic</a>
selection metric. The Kappa distribution generalizes the nine
distributions listed above.</p>
<hr>
<div class="section level3">
<h3 id="list-of-distributions1">List of Distributions<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hosking, J.R.M. &amp;amp; Wallis, J.R., 1997. Regional
frequency analysis: an approach based on L-Moments. Cambridge University
Press, New York, USA.&lt;/p&gt;"><sup>1</sup></a><a class="anchor" aria-label="anchor" href="#list-of-distributions1"></a>
</h3>
<div class="section level4">
<h4 id="gumbel-gum-distribution">Gumbel (GUM) Distribution<a class="anchor" aria-label="anchor" href="#gumbel-gum-distribution"></a>
</h4>
<p><strong>Support</strong></p>
<p><span class="math inline">\(-\infty &lt; x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math inline">\(x(F) = \mu - \sigma \log (-\log
F)\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>Its probability density function (PDF) is:</p>
<p><span class="math display">\[
f(x_{i} : \mu, \sigma) = \frac{1}{\sigma} \exp \left(-z_{i} -
e^{-z_{i}}\right) , \quad
z_{i} = \frac{x_{i} - \mu}{\sigma }
\]</span></p>
<p>Therefore, is Log-likelihood function is:</p>
<p><span class="math display">\[
\ell(x:\mu, \sigma) = \sum_{i=1}^{n} \left[-\ln \sigma - z_{i} -
e^{-z_{i}} \right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>In the equations below, <span class="math inline">\(\gamma \approx
0.5772\)</span> is <a href="https://en.wikipedia.org/wiki/Euler%27s_constant" class="external-link">Eulerâ€™s
constant</a>.</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu + \sigma
\gamma\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \sigma \log
2\)</span></li>
<li><span class="math inline">\(\tau_{3} = \log(9/8)/\log 2 \approx
0.1699\)</span></li>
<li><span class="math inline">\(\tau_{4} = (16 \log 2 - 10\log 3) / \log
2 \approx 0.1504\)</span></li>
</ul>
<p>We can also express the parameters in terms of the L-moments:</p>
<ul>
<li><span class="math inline">\(\sigma = \lambda_{2} / \log
2\)</span></li>
<li><span class="math inline">\(\mu = \lambda_{1} - \sigma
\gamma\)</span></li>
</ul>
</div>
<div class="section level4">
<h4 id="normal-nor-distribution">Normal (NOR) Distribution<a class="anchor" aria-label="anchor" href="#normal-nor-distribution"></a>
</h4>
<p><strong>Support</strong></p>
<p><span class="math inline">\(-\infty &lt; x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math inline">\(x(F) = \mu  + \sigma
\Phi^{-1}(F)\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>Its probability density function (PDF) is:</p>
<p><span class="math display">\[
f(x_{i} : \mu, \sigma) = \frac{1}{\sigma \sqrt{2\pi }}e^{-z_{i}^2/2} ,
\quad
z_{i} = \frac{x_{i} - \mu}{\sigma }
\]</span></p>
<p>Therefore, its Log-likelihood function is:</p>
<p><span class="math display">\[
\ell(x:\mu, \sigma) = \sum_{i=1}^{n} \left[-\ln (\sigma \sqrt{2\pi }) -
\frac{z_{i}^2}{2} \right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \pi^{-1/2}\sigma \approx
0.5642\sigma\)</span></li>
<li><span class="math inline">\(\tau_{3} = 0\)</span></li>
<li><span class="math inline">\(\tau_{4} = 30\pi^{-1}\arctan \sqrt{2} -
9 \approx 0.1226\)</span></li>
</ul>
<p>We can also express the parameters in terms of the L-moments:</p>
<ul>
<li><span class="math inline">\(\mu = \lambda_{1}\)</span></li>
<li><span class="math inline">\(\sigma =
\pi^{1/2}\lambda_{2}\)</span></li>
</ul>
</div>
<div class="section level4">
<h4 id="log-normal-lno-distribution">Log-Normal (LNO) Distribution<a class="anchor" aria-label="anchor" href="#log-normal-lno-distribution"></a>
</h4>
<p><strong>Support</strong></p>
<p><span class="math inline">\(0 &lt; x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math inline">\(x(F) = \exp(\mu + \sigma
\Phi^{-1}(F))\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>To derive its likelihood, we use the fact that:</p>
<p><span class="math display">\[
\text{Data} \sim \text{LNO} \Leftrightarrow \ln (\text{Data}) \sim
\text{NOR}
\]</span></p>
<p>Precisely, we require the change of variables formula, which states
that:</p>
<p><span class="math display">\[
\ell_{\text{LNO}}(x ; \mu, \sigma)
= \ell_{\text{NOR}}(\ln x ; \mu , \sigma) \left|\frac{d}{dx}
\ln  x\right|
= \frac{\ell_{\text{NOR}}(\ln x ; \mu , \sigma)}{x}
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>See <a href="#normal-nor-distribution">Normal Distribution</a>.</p>
</div>
<div class="section level4">
<h4 id="generalized-extreme-value-gev-distribution">Generalized Extreme Value (GEV) Distribution<a class="anchor" aria-label="anchor" href="#generalized-extreme-value-gev-distribution"></a>
</h4>
<p><strong>Support</strong></p>
<p><span class="math display">\[
\begin{cases}
\mu + (\sigma /\kappa) \leq x &lt; \infty &amp; \kappa &gt; 0 \\[5pt]
-\infty &lt; x &lt; \infty &amp; \kappa  = 0 \\[5pt]
-\infty &lt; x \leq \mu + (\sigma/\kappa ) &amp;\kappa &lt; 0
\end{cases}
\]</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math display">\[
x(F) = \begin{cases}
\mu + \sigma (1 - (-\log F)^{\kappa })/\kappa  &amp;\kappa \neq 0\\[5pt]
\mu - \sigma \log (-\log F) &amp;\kappa = 0
\end{cases}
\]</span></p>
<p><strong>Likelihood Function</strong></p>
<p>Its probability density function (PDF) is (assume <span class="math inline">\(t_{i} &gt; 0)\)</span>:</p>
<p><span class="math display">\[
f(x_{i} : \mu, \sigma, \kappa) = \frac{1}{\sigma}t_{i}^{-1 - (1/\kappa)}
\exp (-t_{i}^{-1/\kappa}), \quad
t_{i} = 1 + \kappa \left(\frac{x_{i} - \mu }{\sigma } \right)
\]</span></p>
<p>Therefore, its Log-likelihood is:</p>
<p><span class="math display">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[-\ln \sigma - \left(1
+ \frac{1}{\kappa }\right) \ln t_{i} - t_{i}^{-1/\kappa}\right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined for <span class="math inline">\(\kappa &gt;
-1\)</span>:</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu + \sigma (1 - \Gamma
(1 + \kappa)) / \kappa\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \sigma (1 - 2^{-\kappa
})\Gamma (1 + \kappa) / \kappa\)</span></li>
<li><span class="math inline">\(\tau_{3} = 2(1 - 3^{-\kappa})/(1 -
2^{-\kappa}) - 3\)</span></li>
<li><span class="math inline">\(\tau_{4} = [5(1 - 4^{-\kappa
})-10(1-3^{-\kappa}) + 6(1-2^{-\kappa })]/(1 - 2^{-\kappa
})\)</span></li>
</ul>
<p>To compute the parameters from the L-moments, we first compute <span class="math inline">\(c\)</span>:</p>
<p><span class="math display">\[
c = \frac{2}{3 + \tau_{3}} - \frac{\log 2}{\log 3}
\]</span></p>
<p>Then, we use the following approximation<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hosking, J.R.M., Wallis, J.R., &amp;amp; Wood, E.F., 1985.
Estimation of the generalized extreme-value distribution by the method
of probability-weighted moments. Technometrics, 27, 251-61.&lt;/p&gt;"><sup>2</sup></a>:</p>
<p><span class="math display">\[
\begin{cases}
\kappa \approx 7.8590c + 2.9554c^2 \\[5pt]
\sigma \approx \lambda_{2}\kappa / (1 - 2^{-\kappa })\Gamma (1 + \kappa)
\\[5pt]
\mu \approx \lambda_{1} - \sigma (1 - \Gamma (1 + \kappa )) / \kappa
\end{cases}
\]</span></p>
<p><strong>Note</strong>: Other sources often use a different notation
for the GEV distribution in which the sign of the shape parameter <span class="math inline">\(\kappa\)</span> is flipped.</p>
</div>
<div class="section level4">
<h4 id="generalized-logistic-glo-distribution">Generalized Logistic (GLO) Distribution<a class="anchor" aria-label="anchor" href="#generalized-logistic-glo-distribution"></a>
</h4>
<p><strong>Support</strong></p>
<p><span class="math display">\[
\begin{cases}
-\infty &lt; x \leq \mu + (\sigma /\kappa ) &amp; \kappa  &gt; 0 \\[5pt]
-\infty  &lt; x &lt; \infty  &amp; \kappa  = 0 \\[5pt]
\mu  + (\sigma /\kappa ) \leq  x &lt; \infty  &amp; \kappa  &lt; 0
\end{cases}
\]</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math display">\[
x(F) = \begin{cases}
\mu +\sigma [1 - ((1 - F) / F)^{\kappa}] / \kappa &amp;\kappa \neq 0
\\[5pt]
\mu - \sigma \log ((1 - F) / F) &amp; k = 0
\end{cases}
\]</span></p>
<p><strong>Likelihood Function</strong></p>
<p>Its probability density function (PDF) is (assume <span class="math inline">\(t_{i} &gt; 0)\)</span>:</p>
<p><span class="math display">\[
f(x_{i} : \mu , \sigma , \kappa ) = \frac{1}{\sigma }t_{i}^{(1/\kappa) -
1} \left[1 + t_{i}^{1/\kappa}\right]^{-2}, \quad
t_{i} = 1 - \kappa \left(\frac{x_{i} - \mu }{\sigma }\right)
\]</span></p>
<p>Therefore, its Log-likelihood function is:</p>
<p><span class="math display">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[-\ln \sigma +
\left(\frac{1}{\kappa }-1\right) \ln t_{i} - 2 \ln \left(1 +
t_{i}^{1/\kappa }\right) \right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined for <span class="math inline">\(-1 &lt;
\kappa &lt; 1\)</span>:</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu +\sigma [(1 / \kappa)
- (\pi / \sin (\kappa\pi))]\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \sigma \kappa \pi / \sin
(\kappa \pi)\)</span></li>
<li><span class="math inline">\(\tau_{3} = -\kappa\)</span></li>
<li><span class="math inline">\(\tau_{4} = (1 + 5\kappa ^2) /
6\)</span></li>
</ul>
<p>We can also express the parameters in terms of the L-moments:</p>
<ul>
<li><span class="math inline">\(\kappa = -\tau_{3}\)</span></li>
<li><span class="math inline">\(\sigma = \lambda_{2}\sin (\kappa \pi ) /
\kappa \pi\)</span></li>
<li><span class="math inline">\(\mu = \lambda_{1} - \sigma [(1 / \kappa)
- (\pi / \sin (\kappa\pi))]\)</span></li>
</ul>
</div>
<div class="section level4">
<h4 id="generalized-normal-gno-distribution">Generalized Normal (GNO) Distribution<a class="anchor" aria-label="anchor" href="#generalized-normal-gno-distribution"></a>
</h4>
<p><strong>Support</strong></p>
<p><span class="math display">\[
\begin{cases}
-\infty &lt; x \leq \mu + (\sigma /\kappa ) &amp; \kappa  &gt; 0 \\[5pt]
-\infty  &lt; x &lt; \infty  &amp; \kappa  = 0 \\[5pt]
\mu  + (\sigma /\kappa ) \leq  x &lt; \infty  &amp; \kappa  &lt; 0
\end{cases}
\]</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math display">\[
x(F) = \begin{cases}
\mu + \sigma [1 - \exp(-\kappa \Phi^{-1}(F))] / \kappa &amp;\kappa \neq
0 \\[5pt]
\mu + \sigma \Phi^{-1}(F) &amp;\kappa  = 0
\end{cases}
\]</span></p>
<p><strong>Likelihood Function</strong></p>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined for all values of <span class="math inline">\(\kappa\)</span>.</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu + \sigma (1 -
e^{\kappa ^2/2}) / \kappa\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \sigma e^{-\kappa ^2/ 2}[1
- 2\Phi (-\kappa  / \sqrt{2})] / \kappa\)</span></li>
</ul>
<p>To compute <span class="math inline">\(\tau_{3}\)</span> and <span class="math inline">\(\tau_{4}\)</span> we use the following
approximation:</p>
<p><span class="math display">\[
\begin{aligned}
\tau_{3} &amp;\approx -\kappa \left(\frac{A_{0} + A_{1}\kappa ^2 +
A_{2}\kappa ^{4} + A_{3}\kappa ^{6}}{1 + B_{1}\kappa ^2 + B_{2}\kappa
^{4} + B_{3}\kappa ^{6}}\right)  \\[5pt]
\tau_{4} &amp;\approx \tau_{4}^{0} + \kappa ^2 \left(\frac{C_{0} +
C_{1}\kappa ^2 + C_{2}\kappa ^{4} + C_{3}\kappa ^{6}}{1 + D_{1}\kappa ^2
+ D_{2}\kappa ^{4} + D_{3}\kappa ^{6}}\right)
\end{aligned}
\]</span></p>
<p>To determine the parameters from the L-moments we also use a rational
approximation:</p>
<p><span class="math display">\[
\kappa \approx -\tau_{3} \left(\frac{E_{0} + E_{1}\tau_{3}^2 +
E_{2}\tau_{3}^{4} + E_{3}\tau _{3}^{6}}{1 + F_{1}\tau _{3}^2 + F_{2}\tau
_{3}^{4} + F_{3}\tau _{3}^{6}}\right)
\]</span></p>
<p>Then, we can find <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> as a function of <span class="math inline">\(\kappa\)</span>:</p>
<p><span class="math display">\[
\sigma \approx  \frac{\lambda_{2}\kappa e^{-\kappa ^2 / 2}}{1 - 2\Phi
(-\kappa  / \sqrt{2})}, \quad
\mu  \approx  \lambda_{1} - \frac{\sigma }{\kappa }\left(1 - e^{-\kappa
^2 / 2 }\right)
\]</span></p>
<p>The coefficients (<span class="math inline">\(A_{i}\)</span>, <span class="math inline">\(B_{i}\)</span>, <span class="math inline">\(C_{i}\)</span>, <span class="math inline">\(D_{i}\)</span>, <span class="math inline">\(E_{i}\)</span>, <span class="math inline">\(F_{i}\)</span>, and <span class="math inline">\(\tau_{4}^{0}\)</span>) are defined in Appendix A.8
of Hosking, 1997<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hosking, J.R.M. &amp;amp; Wallis, J.R., 1997. Regional
frequency analysis: an approach based on L-Moments. Cambridge University
Press, New York, USA.&lt;/p&gt;"><sup>3</sup></a>. Although this appendix covers the
3-parameter log-normal distribution, the L-moments of the generalized
normal distribution are the same.</p>
</div>
<div class="section level4">
<h4 id="pearson-type-iii-pe3-distribution">Pearson Type III (PE3) Distribution<a class="anchor" aria-label="anchor" href="#pearson-type-iii-pe3-distribution"></a>
</h4>
<p>The Pearson Type III distribution is typically reparameterized as
follows for <span class="math inline">\(\kappa \neq 0\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha &amp;= 4 / \kappa^2 \\[5pt]
\beta  &amp;= \sigma |\kappa | / 2 \\[5pt]
\xi &amp;= \mu  - 2\sigma /\kappa
\end{aligned}
\]</span></p>
<p><strong>Support</strong></p>
<p><span class="math display">\[
\begin{cases}
\xi \leq  x &lt; \infty &amp;\kappa &gt; 0 \\[5pt]
-\infty &lt; x &lt; \infty  &amp;\kappa =0 \\[5pt]
-\infty  &lt; x \leq \xi &amp;\kappa  &lt; 0
\end{cases}
\]</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math display">\[
x(F) = \begin{cases}
\mu - \alpha \beta + q(F, \alpha, \beta) &amp;\kappa &gt; 0\\[5pt]
\mu + \sigma \Phi^{-1}(F) &amp;\kappa  = 0\\[5pt]
\mu  + \alpha \beta  - q(1 - F, \alpha, \beta) &amp;\kappa &lt; 0
\end{cases}
\]</span></p>
<p>In the equations above, <span class="math inline">\(q\)</span> is the
quantile function of the Gamma distribution with shape <span class="math inline">\(\alpha\)</span> and scale <span class="math inline">\(\beta\)</span>. <span class="math inline">\(q\)</span> is defined below, where <span class="math inline">\(\gamma\)</span> is the <em>lower incomplete Gamma
function</em>.</p>
<p><span class="math display">\[q(F, \alpha, \beta) = \beta \gamma
^{-1}(\alpha, p \Gamma (\alpha))\]</span></p>
<p><strong>Likelihood Function</strong></p>
<p>The probability density function (PDF) of the PE3 distribution is
given below:</p>
<p><span class="math display">\[
f(x_{i} : \mu , \sigma , \kappa ) = \frac{(x_{i} - \xi)^{\alpha  -
1}e^{-(x_{i} - \xi )/\beta }}{\beta ^{\alpha } \Gamma (\alpha )}
\]</span></p>
<p>Therefore, its Log-likelihood function is:</p>
<p><span class="math display">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[(\alpha  - 1) \ln
|x_{i} - \xi | - \frac{|x_{i} - \xi  |}{\beta } - \alpha \ln\beta  - \ln
\Gamma (\alpha )\right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>All subsequent definitions assume that <span class="math inline">\(\kappa &gt; 0\)</span>. If <span class="math inline">\(\kappa &lt; 0\)</span>, the L-moments can be
obtained by changing the signs of <span class="math inline">\(\lambda_{1}\)</span>, <span class="math inline">\(\tau_{3}\)</span>, and <span class="math inline">\(\xi\)</span> whenever they appear. If <span class="math inline">\(\kappa = 0\)</span>, the L-moments are the same as
the <a href="#normal-nor-distribution">Normal Distribution</a>. The
first two L-moments are defined as follows:</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \xi + \alpha
\beta\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \pi ^{-1/2} \beta \Gamma
(\alpha  + 0.5) / \Gamma (\alpha )\)</span></li>
</ul>
<p>Rational approximation is necessary to determine <span class="math inline">\(\tau_{3}\)</span> and <span class="math inline">\(\tau_{4}\)</span>. If <span class="math inline">\(\alpha \geq 1\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\tau_{3} &amp;\approx \alpha^{-1/2} \left(\frac{A_{0} + A_{1}\alpha^{-1}
+ A_{2}\alpha^{-2} + A_{3}\alpha^{-3}}{1 + B_{1}\alpha^{-1} +
B_{2}\alpha ^{-2}}\right)  \\[5pt]
\tau_{4} &amp;\approx \frac{C_{0} + C_{1}\alpha^{-1} + C_{2}\alpha ^{-2}
+C_{3}\alpha ^{-3}}{1 + D_{1}\alpha ^{-1} + D_{2}\alpha ^{-2}}
\end{aligned}
\]</span></p>
<p>If <span class="math inline">\(\alpha &lt; 1\)</span>, we use a
different set of coefficients:</p>
<p><span class="math display">\[
\begin{aligned}
\tau_{3} &amp;\approx \frac{1 + E_{1}\alpha  + E_{2}\alpha ^2 +
E_{3}\alpha ^3}{1 + F_{1}\alpha  + F_{2}\alpha ^2 + F_{3}\alpha ^3}
\\[5pt]
\tau_{4} &amp;\approx \frac{1 + G_{1}\alpha + G_{2}\alpha ^2 +
G_{3}\alpha ^3}{1 + H_{1}\alpha + H_{2}\alpha ^2 + H_{3}\alpha ^3}
\end{aligned}
\]</span></p>
<p>Coefficients are given in Appendix A.9 of Hosking, 1997<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Hosking, J.R.M. &amp;amp; Wallis, J.R., 1997. Regional
frequency analysis: an approach based on L-Moments. Cambridge University
Press, New York, USA.&lt;/p&gt;"><sup>4</sup></a>. To estimate
parameters from the L-moments, we use one of two approximations for
<span class="math inline">\(\alpha\)</span> depending on the value of
<span class="math inline">\(\tau_{3}\)</span>:</p>
<p><span class="math display">\[
\alpha \approx \begin{cases}
\frac{1 + 0.2906z}{z + 0.1882z^2 + 0.0442z^3}, &amp;z = 3\pi \tau_{3}^2,
&amp;0 &lt; |\tau_{3}| &lt; \frac{1}{3} \\[5pt]
\frac{0.36067z - 0.59567z^2 + 0.25361z^3}{1 - 2.78861z + 2.56096z^2 -
0.77045z^3}, &amp;z = 1 - |\tau_{3}|, &amp;\frac{1}{3} \leq |\tau_{3}|
&lt; 1
\end{cases}
\]</span></p>
<p>Then, we can determine the parameters from the approximated <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\kappa &amp;= 2\alpha ^{-1/2} \text{sign} (\tau_{3}) \\[5pt]
\sigma &amp;= \lambda_{2} \pi^{1/2}\alpha ^{1/2} \Gamma (\alpha )/\Gamma
(\alpha + 0.5)\\[5pt]
\mu &amp;= \lambda_{1 }
\end{aligned}
\]</span></p>
</div>
<div class="section level4">
<h4 id="log-pearson-type-iii-lp3-distribution">Log-Pearson Type III (LP3) Distribution<a class="anchor" aria-label="anchor" href="#log-pearson-type-iii-lp3-distribution"></a>
</h4>
<p>The LP3 distribution uses the same reparameterization as the <a href="#pearson-type-iii-pe3-distribution">PE3 distribution</a>.</p>
<p><strong>Support</strong></p>
<p><span class="math display">\[
\begin{cases}
\max(0, \xi) \leq  x &lt; \infty &amp;\kappa &gt; 0 \\[5pt]
0 &lt; x &lt; \infty  &amp;\kappa =0 \\[5pt]
0  &lt; x \leq \max(0, \xi) &amp;\kappa  &lt; 0
\end{cases}
\]</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math inline">\(x(F) = \exp(x_{\text{PE3}}(F ))\)</span>,
where <span class="math inline">\(x_{\text{PE3}}(F)\)</span> is the
quantile function of the <a href="#pearson-type-iii-pe3-distribution">PE3 distribution</a>.</p>
<p><strong>Likelihood Function</strong></p>
<p>To derive the likelihood of the LP3 distribution, we use the fact
that:</p>
<p><span class="math display">\[
\text{Data} \sim \text{LP3}  \Leftrightarrow \ln (\text{Data}) \sim
\text{PE3}
\]</span></p>
<p>Precisely, we require the change of variables formula, which states
that:</p>
<p><span class="math display">\[
\ell_{\text{LP3}}(x ; \mu, \sigma, \kappa)
= \ell_{\text{PE3}}(\ln x ; \mu , \sigma, \kappa ) \left|\frac{d}{dx}
\ln  x\right|
= \frac{\ell_{\text{PE3}}(\ln x ; \mu , \sigma, \kappa )}{x}
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>Same as the <a href="#pearson-type-iii-pe3-distribution">PE3
distribution</a>.</p>
</div>
<div class="section level4">
<h4 id="weibull-wei-distribution">Weibull (WEI) Distribution<a class="anchor" aria-label="anchor" href="#weibull-wei-distribution"></a>
</h4>
<p>The Weibull distribution is implemented as a reparameterized version
of the generalized extreme value distribution:</p>
<p><span class="math display">\[
\begin{aligned}
\kappa &amp;= 1 / \kappa_{\text{GEV}} \\[5pt]
\sigma &amp;= \kappa \sigma_{\text{GEV} } \\[5pt]
\mu &amp;= \sigma + \mu_{\text{GEV} }
\end{aligned}
\]</span></p>
<p>Under this reparameterization, it is required that <span class="math inline">\(\sigma &gt; 0\)</span> and <span class="math inline">\(\kappa &gt; 0\)</span>.</p>
<p><strong>Support</strong></p>
<p><span class="math inline">\(\mu \leq x &lt; \infty\)</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math inline">\(x(F) = \mu + \sigma (-\log (1 -
F))^{1/\kappa}\)</span></p>
<p><strong>Likelihood Function</strong></p>
<p>Its probability density function (PDF) is given below for <span class="math inline">\(x_{i} &gt; \mu\)</span>:</p>
<p><span class="math display">\[
f(x_{i} : \mu, \sigma, \kappa) = \frac{\kappa}{\sigma }\left(\frac{x_{i}
- \mu}{\sigma }\right)^{\kappa -1} \exp \left( - \left(\frac{x_{i} -
\mu}{\sigma }\right)^{\kappa } \right)
\]</span></p>
<p>Therefore, its Log-likelihood function is:</p>
<p><span class="math display">\[
\ell(x:\mu, \sigma, \kappa) = \sum_{i=1}^{n} \left[\ln \kappa - \kappa
\ln \sigma +(\kappa -1)\ln (x_{i}-\mu ) - \left(\frac{x_{i} - \mu
}{\sigma }\right) ^{\kappa } \right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>First, reparameterize the Weibull distribution to recover the GEV
parameters:</p>
<p><span class="math display">\[
\begin{aligned}
\kappa_{\text{GEV}} &amp;= 1 / \kappa \\[5pt]
\sigma_{\text{GEV}} &amp;= \sigma / \kappa \\[5pt]
\end{aligned}
\]</span></p>
<p>Next, compute the L-moments for the <a href="#generalized-extreme-value-gev-distribution">GEV distribution</a>
with <span class="math inline">\(\mu_{\text{GEV}} = 0\)</span>.
Then,</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu + \sigma - \lambda_{1,
\text{GEV}}\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \lambda_{2,
\text{GEV}}\)</span></li>
<li><span class="math inline">\(\tau_{3} = -\tau_{3,
\text{GEV}}\)</span></li>
<li><span class="math inline">\(\tau_{4} = \tau_{4, \text{GEV}
}\)</span></li>
</ul>
<p>To compute the parameters from the L-moments, first flip the sign of
<span class="math inline">\(\lambda_{1}\)</span> and <span class="math inline">\(\tau_{3}\)</span>. Then, estimate the parameters
of the GEV distribution to get <span class="math inline">\(\hat{\mu}_{\text{GEV}}\)</span>, <span class="math inline">\(\hat{\sigma}_{\text{GEV}}\)</span>, and <span class="math inline">\(\hat{\kappa}_{\text{GEV}}\)</span>. Finally,
reparameterize the GEV parameters as shown <a href="#weibull-wei-distribution">here</a> and then flip the sign of
<span class="math inline">\(\mu\)</span>.</p>
</div>
<div class="section level4">
<h4 id="kappa-kap-distribution">Kappa (KAP) Distribution<a class="anchor" aria-label="anchor" href="#kappa-kap-distribution"></a>
</h4>
<p>The Kappa distribution has location <span class="math inline">\(\mu\)</span>, scale <span class="math inline">\(\sigma\)</span>, and two shape parameters <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(h\)</span>.</p>
<p><strong>Support</strong></p>
<p><span class="math display">\[
\begin{cases}
\mu + \sigma (1 - h^{-\kappa}) \leq x \leq \mu + (\sigma /\kappa ) &amp;
\kappa &gt; 0, h &gt; 0 \\[5pt]
-\infty &lt; x \leq \mu + (\sigma /\kappa) &amp; \kappa &gt; 0, h \leq 0
\\[5pt]
\mu + \sigma (1 - h^{-\kappa}) \leq x &lt; \infty &amp;\kappa \leq 0, h
&gt; 0 \\[5pt]
\mu + (\sigma / \kappa ) \leq x &lt;\infty &amp;\kappa  \leq 0, h \leq 0
\end{cases}
\]</span></p>
<p><strong>Quantiles</strong></p>
<p><span class="math display">\[
x(F) = \mu + \frac{\sigma }{\kappa }\left[1 - \left(\frac{1 -
F^{h}}{h}\right)^{\kappa }\right]
\]</span></p>
<p><strong>L-Moments</strong></p>
<p>The L-moments are defined if <span class="math inline">\(h \geq
0\)</span> and <span class="math inline">\(k &gt; -1\)</span> or if
<span class="math inline">\(h &lt; 0\)</span> and <span class="math inline">\(-1 &lt; k &lt; -1/h\)</span>.</p>
<ul>
<li><span class="math inline">\(\lambda_{1} = \mu  + \sigma (1 -
g_{1})/\kappa\)</span></li>
<li><span class="math inline">\(\lambda_{2} = \sigma(g_{1} -
g_{2})/\kappa\)</span></li>
<li><span class="math inline">\(\tau_{3} = (-g_{1} + 3g_{2} - 2g_{3}) /
(g_{1} - g_{2})\)</span></li>
<li><span class="math inline">\(\tau_{4} = (-g_{1} + 6g_{2} - 10g_{3} +
5g_{4}) / (g_{1} - g_{2})\)</span></li>
</ul>
<p>In the expression above, <span class="math inline">\(g_{r}\)</span>
is defined as follows:</p>
<p><span class="math display">\[
g_{r} = \begin{cases}
\frac{r\Gamma (1 + \kappa )\Gamma (r / h)}{h^{1 + \kappa }\Gamma (1 +
\kappa + r/h)} &amp;h &gt; 0 \\[5pt]
\frac{r\Gamma (1 + \kappa ) \Gamma (-\kappa  - r/h)}{(-h)^{1 + \kappa
}\Gamma (1 - r/h)} &amp;h &lt; 0
\end{cases}
\]</span></p>
<p>There is no closed-form solution for the parameters in terms of the
L-moments. However, <span class="math inline">\(\tau_{3}\)</span> and
<span class="math inline">\(\tau_{4}\)</span> can be computed in terms
of <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(h\)</span> using Newton-Raphson iteration.</p>
</div>
</div>
<div class="section level3">
<h3 id="sources">Sources<a class="anchor" aria-label="anchor" href="#sources"></a>
</h3>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riley Wheadon, CuauhtÃ©moc Vidrio-SahagÃºn, Alain Pietroniro, Jianxun He, Environment and Climate Change Canada (ECCC).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
