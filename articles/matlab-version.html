<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MATLAB Version • ffaframework</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MATLAB Version">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ffaframework</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/trend-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/trend-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/stationary-ffa.html">Stationary FFA</a></li>
    <li><a class="dropdown-item" href="../articles/non-stationary-ffa.html">Nonstationary FFA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-wiki" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Wiki</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-wiki">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/eda-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eda-change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/ffa-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-probability-distributions.html">Probability Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-uncertainty-quantification.html">Uncertainty Quantification</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-assessment.html">Model Assessment</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../articles/matlab-version.html">MATLAB Version</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rileywheadon/ffa-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MATLAB Version</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rileywheadon/ffa-package/blob/master/vignettes/articles/matlab-version.Rmd" class="external-link"><code>vignettes/articles/matlab-version.Rmd</code></a></small>
      <div class="d-none name"><code>matlab-version.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="changes-from-matlab-version">Changes from MATLAB Version<a class="anchor" aria-label="anchor" href="#changes-from-matlab-version"></a>
</h2>
<p>This page documents changes from <a href="https://zenodo.org/records/8012096" class="external-link">original MATLAB code</a>.</p>
<div class="section level3">
<h3 id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis-eda"></a>
</h3>
<div class="section level4">
<h4 id="bug-fixes">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes"></a>
</h4>
<ul>
<li>Only show statistically significant change points for the Pettitt
and MKS plots.</li>
<li>Fix bug causing the MKS test to only identify one change point, even
if multiple change points were found to be above the threshold for
statistical significance.</li>
<li>Fix major bug causing the MKS test to identify change points based
on the progressive series instead of the z-statistics of the crossing
points.</li>
<li>Remove unnecessary rounding in the moving window algorithm for
estimating variability.</li>
<li>Re-implement the Phillips-Perron and KPSS tests to account for drift
and trend.</li>
</ul>
</div>
<div class="section level4">
<h4 id="framework-changes">Framework Changes<a class="anchor" aria-label="anchor" href="#framework-changes"></a>
</h4>
<ul>
<li>If serial correlation is identified, do not run the Phillips-Perron
and KPSS tests.</li>
<li>Add the the Runs test to detect nonlinearity after fitting Sen’s
trend estimator.</li>
<li>Run change point detection in multiple stages to prevent
overpartitioning.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="flood-frequency-analysis-ffa">Flood Frequency Analysis (FFA)<a class="anchor" aria-label="anchor" href="#flood-frequency-analysis-ffa"></a>
</h3>
<div class="section level4">
<h4 id="distribution-changes">Distribution Changes<a class="anchor" aria-label="anchor" href="#distribution-changes"></a>
</h4>
<p>The generalized Pareto (GPA) distribution has been removed, since its
likelihood function is not amenable to maximum likelihood estimation.
Issues occur because the GPA distribution is intended for peaks over
threshold modeling, which we do not use.</p>
<p>The R version uses the three parameter Weibull distribution (with
location, scale, and shape) parameters instead of the two parameter
Weibull distribution (with scale and shape parameters). This ensures
consistency with the other distributions, which all have location
parameters.</p>
</div>
<div class="section level4">
<h4 id="model-selection-changes">Model Selection Changes<a class="anchor" aria-label="anchor" href="#model-selection-changes"></a>
</h4>
<p>The L-distance and L-kurtosis selection methods have been improved by
using an optimization algorithm to find the parameters with the closest
L-moments to the data instead of using a brute force approach. This is
more computationally efficient and gives more precise results.</p>
<p>The procedure for computing the Z-statistic selection metric has been
changed. If the L-moments of the dataset do not satisfy <span class="math inline">\(\tau_{4} \leq (1 + 5\tau _{3}^2)/6\)</span>, then
the Kappa distribution will not be fitted and the candidate
distributions that use the dataset will be omitted.</p>
</div>
<div class="section level4">
<h4 id="parameter-estimation-changes">Parameter Estimation Changes<a class="anchor" aria-label="anchor" href="#parameter-estimation-changes"></a>
</h4>
<p>Parameterization of the PE3/LP3 distributions fails for some datasets
because MATLAB is unable to handle the large numbers created by the
gamma function. To manage this issue, the MATLAB version used the
conventional moments (i.e. sample mean/variance/skewness) when this
occurred. We avoid this problem in the R version by using the
<code>lgamma</code> (log-gamma) function.</p>
<p>The R implementation uses L-BFGS-B for MLE/GMLE parameter estimation
instead of Nelder-Mead, since the gradient is well defined for the
likelihood functions we are working with. Additionally, the L-BFGS-B
method makes it possible to assign bounds to the variables. This
modification produced slight improvements to the MLL/GMLL for some
datasets.</p>
</div>
<div class="section level4">
<h4 id="uncertainty-quantification">Uncertainty Quantification<a class="anchor" aria-label="anchor" href="#uncertainty-quantification"></a>
</h4>
<p>Implement RFPL uncertainty quantification for the Weibull
distribution.</p>
</div>
<div class="section level4">
<h4 id="model-assessment-changes">Model Assessment Changes<a class="anchor" aria-label="anchor" href="#model-assessment-changes"></a>
</h4>
<p>Use the built-in R function <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code> to perform
log-linear interpolation of the return periods. The MATLAB
implementation uses a hard-coded algorithm which behaves unpredictably
when the original and interpolated <span class="math inline">\(x\)</span>-values are equal.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riley Wheadon, Cuauhtémoc Vidrio-Sahagún, Alain Pietroniro, Jianxun He, Environment and Climate Change Canada (ECCC).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
