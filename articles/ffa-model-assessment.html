<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> â€¢ ffaframework</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ffaframework</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/trend-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/trend-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/stationary-ffa.html">Stationary FFA</a></li>
    <li><a class="dropdown-item" href="../articles/non-stationary-ffa.html">Nonstationary FFA</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-wiki" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Wiki</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-wiki">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/eda-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eda-change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/ffa-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-probability-distributions.html">Probability Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-uncertainty-quantification.html">Uncertainty Quantification</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-assessment.html">Model Assessment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/matlab-version.html">MATLAB Version</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rileywheadon/ffa-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rileywheadon/ffa-package/blob/master/vignettes/articles/ffa-model-assessment.Rmd" class="external-link"><code>vignettes/articles/ffa-model-assessment.Rmd</code></a></small>
      <div class="d-none name"><code>ffa-model-assessment.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="model-assessment">Model Assessment<a class="anchor" aria-label="anchor" href="#model-assessment"></a>
</h2>
<div class="section level3">
<h3 id="nonparametric-models">Nonparametric Models<a class="anchor" aria-label="anchor" href="#nonparametric-models"></a>
</h3>
<p>A <strong>Plotting Position</strong> is a non-parametric estimator of
exceedance probabilities. By using the plotting position, we can
evaluate the quality of a stationary parametric model. To compute the
plotting position, arrange the sample observations in descending order
of magnitude: <span class="math inline">\(x_{n:n} \geq \dots \geq
x_{1:n}\)</span>. Then, the exceedance probabilities are given by the
following formula:</p>
<p><span class="math display">\[
p_{i:n} = \frac{i-a}{n+1 - 2a}, \quad i \in \{1, \dots , n\}
\]</span></p>
<p>The coefficient <span class="math inline">\(a\)</span> depends on the
plotting position formula:</p>
<table class="table">
<thead><tr class="header">
<th>Formula</th>
<th><span class="math inline">\(a\)</span></th>
<th>Simplified Equation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Weibull</td>
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\(p_{i:n} = \frac{i}{n +1}\)</span></td>
</tr>
<tr class="even">
<td>Blom</td>
<td><span class="math inline">\(0.375\)</span></td>
<td><span class="math inline">\(p_{i:n} = \frac{i-0.375}{n +
0.25}\)</span></td>
</tr>
<tr class="odd">
<td>Cunnane</td>
<td><span class="math inline">\(0.4\)</span></td>
<td><span class="math inline">\(p_{i:n} =
\frac{i-0.4}{n+0.2}\)</span></td>
</tr>
<tr class="even">
<td>Gringorten</td>
<td><span class="math inline">\(0.44\)</span></td>
<td><span class="math inline">\(p_{i:n} = \frac{i-0.44}{n +
0.12}\)</span></td>
</tr>
<tr class="odd">
<td>Hazen</td>
<td><span class="math inline">\(0.5\)</span></td>
<td><span class="math inline">\(p_{i:n} = \frac{i-0.5}{n}\)</span></td>
</tr>
</tbody>
</table>
<p>By default, the FFA framework uses the Weibull formula, which is
unbiased.</p>
</div>
<div class="section level3">
<h3 id="accuracy-statistics">Accuracy Statistics<a class="anchor" aria-label="anchor" href="#accuracy-statistics"></a>
</h3>
<div class="section level4">
<h4 id="r2---coefficient-of-determination">
<span class="math inline">\(R^2\)</span> - Coefficient of
Determination<a class="anchor" aria-label="anchor" href="#r2---coefficient-of-determination"></a>
</h4>
<p>To compute the <span class="math inline">\(R^2\)</span> statistic, we
perform a linear regression of the annual maximum series data against
the predictions of the parametric model at the plotting positions. The
<span class="math inline">\(R^2\)</span> statistic describes how well
the parametric model captures variance in the data. Higher is better.
The plot below shows the deviation of the model (red dots), from the
data (black line).</p>
<p><img src="../reference/figures/plot-assessment.svg"></p>
</div>
<div class="section level4">
<h4 id="rmse---root-mean-squared-error">RMSE - Root-Mean Squared Error<a class="anchor" aria-label="anchor" href="#rmse---root-mean-squared-error"></a>
</h4>
<p>The <code>RMSE</code> statistic describes the average
<em>squared</em> difference between the data and the predictions of the
parametric model. Lower is better.</p>
</div>
<div class="section level4">
<h4 id="bias">Bias<a class="anchor" aria-label="anchor" href="#bias"></a>
</h4>
<p>The <code>Bias</code> statistic describes the average difference
between the data and the predictions of the parametric model. A positive
bias indicates that the model tends to <em>overestimate</em> the data
while a negative bias indicates that the model tends to
<em>underestimate</em> the data.</p>
</div>
</div>
<div class="section level3">
<h3 id="information-criterion">Information Criterion<a class="anchor" aria-label="anchor" href="#information-criterion"></a>
</h3>
<p>The <strong>Akaike Information Criterion</strong> (<code>AIC</code>)
and <strong>Bayesian Information Criterion</strong> (<code>BIC</code>)
describe the quality of a model based on the error (<code>RMSE</code>)
and the number of parameters (<code>n_theta</code>). Better models have
a lower <code>AIC</code>/<code>BIC</code>, which indicates that they
have <em>less</em> parameters and <em>lower</em> error.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AIC</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">RMSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n_theta</span><span class="op">)</span></span>
<span><span class="va">BIC</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">RMSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">n_theta</span><span class="op">)</span></span></code></pre></div>
<p>The Akaike/Bayesian information criterion can also be computed using
the maximum log-likelihood from <a href="parameter-estimation.html#maximum-likelihood-mle">maximum likelihood
estimation</a>. These statistics are reported as <code>AIC_MLL</code>
and <code>BIC_MLL</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AIC_MLL</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">MLL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n_theta</span><span class="op">)</span></span>
<span><span class="va">BIC_MLL</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">MLL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">n_theta</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="uncertainty-statistics">Uncertainty Statistics<a class="anchor" aria-label="anchor" href="#uncertainty-statistics"></a>
</h3>
<p>The FFA framework uses three statistics to assess the uncertainty in
flood quantile estimates:</p>
<ul>
<li>
<code>AW</code> captures <em>precision</em> (narrower confidence
intervals are better).</li>
<li>
<code>POC</code> captures <em>reliability</em> (higher coverage of
observations is better).</li>
<li>
<code>CWI</code> is a composite measure balancing both precision and
reliability (lower is better).</li>
</ul>
<p>We use these metrics together to evaluate the robustness of the flood
frequency analysis.</p>
<div class="section level4">
<h4 id="aw-average-width">AW â€“ Average Width<a class="anchor" aria-label="anchor" href="#aw-average-width"></a>
</h4>
<p><code>AW</code> is the average width of the interpolated confidence
intervals across return periods of interest. A smaller <code>AW</code>
indicates more <em>precise</em> quantile estimates. To compute
<code>AW</code>, we use log-linear interpolation to estimate the
confidence intervals of the exceedance probabilities from the confidence
intervals computed during <a href="uncertainty-quantification.html">uncertainty quantification</a>.</p>
</div>
<div class="section level4">
<h4 id="poc-percent-of-coverage">POC â€“ Percent of Coverage<a class="anchor" aria-label="anchor" href="#poc-percent-of-coverage"></a>
</h4>
<p><code>POC</code> is the percentage of data points that fall within
their corresponding confidence intervals. A higher <code>POC</code>
indicates greater <em>reliability</em> of the confidence intervals.</p>
</div>
<div class="section level4">
<h4 id="cwi-confidence-width-indicator">CWI â€“ Confidence Width Indicator<a class="anchor" aria-label="anchor" href="#cwi-confidence-width-indicator"></a>
</h4>
<p><code>CWI</code> is a composite metric that penalizes wide and/or
poorly calibrated confidence intervals.</p>
<ul>
<li>A lower <code>CWI</code> is better.</li>
<li>Wide intervals and low coverage increase the penalty.</li>
<li>Ideal confidence intervals are both narrow and well-calibrated,
resulting in a low <code>CWI</code>.</li>
</ul>
<p>The <code>CWI</code> is computed using the following formula, where
<code>alpha</code> is the significance level.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CWI</span> <span class="op">&lt;-</span> <span class="va">AW</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">-</span> <span class="va">POC</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="handling-nonstationarity">Handling Nonstationarity<a class="anchor" aria-label="anchor" href="#handling-nonstationarity"></a>
</h3>
<p>When working with nonstationary models, adjustments must be made to
both the empirical quantiles (derived from the plotting positions) and
the theoretical quantiles. In the FFA framework, we perform
nonstationary model assessment by standardizing the quantiles based on
the selected distribution family.</p>
<p>Standardizing the theoretical quantiles:</p>
<ol style="list-style-type: decimal">
<li>Get nonexceedance probabilities <span class="math inline">\(p_{(1)}
\leq \dots \leq p_{(n)}\)</span> using any plotting position
formula.</li>
<li>Compute the normalized theoretical quantiles <span class="math inline">\(z^{T}_{i} = \Phi^{-1}(p_{(i)})\)</span>.</li>
</ol>
<p>Standardizing the empirical quantiles:</p>
<ol style="list-style-type: decimal">
<li>
<p>Transform each observation <span class="math inline">\(x_{i}\)</span> into a model-based probability
<span class="math inline">\(u_{i}\)</span>:</p>
<p><span class="math display">\[
u_i = F(x_i \,;\, \mu(t_i), \sigma(t_i), \kappa)
\]</span></p>
</li>
<li>
<p>Normalize the model-based probabilities:</p>
<p><span class="math display">\[
z_{i} = \Phi^{-1}(u_{i})
\]</span></p>
</li>
<li><p>Sort the normalized empirical quantiles: <span class="math inline">\(z^{E}_{(1)} \leq \dots \leq
z^{E}_{(n)}\)</span>.</p></li>
</ol>
<p>Then, we can plot the <span class="math inline">\((z_{i}^{T},
z_{i}^{E})\)</span> pairs in a <em>normalized Q-Q plot</em>.
Alternatively, we can use a <em>detrended Q-Q plot</em> (also known as a
<em>worm plot</em>), which plots the theoretical quantiles <span class="math inline">\(z_{i}^{T}\)</span> against the differences <span class="math inline">\(\Delta_{i} = z_{i}^{E} - z_{i}^{T}\)</span>. If
the model accurately captures the true distribution of the data,
then:</p>
<p><span class="math display">\[
\text{SE}(\Delta_{i})= \frac{1}{f(z_{i}^{T})} \sqrt{\frac{p_{(i)}(1 -
p_{(i)})}{n}}
\]</span></p>
<p>We can use this formula to plot the 95% confidence interval at <span class="math inline">\(\pm 1.96 \cdot \text{SE}(\Delta
_{i})\)</span>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riley Wheadon, CuauhtÃ©moc Vidrio-SahagÃºn, Alain Pietroniro, Jianxun He, Environment and Climate Change Canada (ECCC).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
