<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Stationary FFA • ffaframework</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stationary FFA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ffaframework</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/trend-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/trend-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/stationary-ffa.html">Stationary FFA</a></li>
    <li><a class="dropdown-item" href="../articles/non-stationary-ffa.html">Nonstationary FFA</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/wrapper-functions.html">Using Wrapper Functions</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-wiki" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Wiki</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-wiki">
<li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/eda-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eda-change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/ffa-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-probability-distributions.html">Probability Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-uncertainty-quantification.html">Uncertainty Quantification</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-assessment.html">Model Assessment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/matlab-version.html">MATLAB Version</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rileywheadon/ffa-framework/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stationary FFA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rileywheadon/ffa-framework/blob/master/vignettes/stationary-ffa.Rmd" class="external-link"><code>vignettes/stationary-ffa.Rmd</code></a></small>
      <div class="d-none name"><code>stationary-ffa.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to use the <code>ffaframework</code>
package to perform flood frequency analysis (model selection, parameter
estimation, uncertainty quantification, and model performance
assessment) under the assumption of stationarity.</p>
<p>The results are expressed in terms of <em>return periods</em> and
<em>return levels</em>. The <em>return period</em> of a flood is the
expected number of years between annual maximum events of equal or
greater magnitude while the <em>return level</em> is the magnitude of
the annual maximum event, measured in <span class="math inline">\(\text{m}^3/\text{s}\)</span>.</p>
<div class="section level2">
<h2 id="case-study">Case Study<a class="anchor" aria-label="anchor" href="#case-study"></a>
</h2>
<p>This vignette will explore data from the Athabasca River at Athabasca
(07BE001), an unregulated hydrological monitoring station. A statistical
analysis of the data from this station does not reveal any evidence of
trends in the mean or variability of the data. Data for this station is
provided as <code>CAN-07BE001.csv</code> in the
<code>ffaframework</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rileywheadon.github.io/ffa-framework/" class="external-link">ffaframework</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_local.html">data_local</a></span><span class="op">(</span><span class="st">"CAN-07BE001.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year  max</span></span>
<span><span class="co">#&gt; 1 1913 1670</span></span>
<span><span class="co">#&gt; 2 1914 3090</span></span>
<span><span class="co">#&gt; 3 1915 2760</span></span>
<span><span class="co">#&gt; 4 1916 2080</span></span>
<span><span class="co">#&gt; 5 1917 2490</span></span>
<span><span class="co">#&gt; 6 1918 1470</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_ams_data.html">plot_ams_data</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="va">df</span><span class="op">$</span><span class="va">year</span>, title <span class="op">=</span> <span class="st">"Athabasca River at Athabasca (07BE001)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="stationary-ffa_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="distribution-selection">Distribution Selection<a class="anchor" aria-label="anchor" href="#distribution-selection"></a>
</h2>
<p>First, a suitable probability distribution for the data is selected
using the L-moments.</p>
<ol style="list-style-type: decimal">
<li>
<code>select_ldistance</code> chooses the distribution with
theoretical L-skewness (<span class="math inline">\(\tau_3\)</span>) and
L-kurtosis (<span class="math inline">\(\tau_4\)</span>) closest to the
sample, based on Euclidean distance.</li>
<li>
<code>select_lkurtosis</code> selects the distribution with the
smallest difference between sample and theoretical L-kurtosis (for
three-parameter distributions only).</li>
<li>
<code>select_zstatistic</code> uses a fitted 4-parameter Kappa
distribution to estimate the sampling distribution of the L-kurtosis and
selects the distribution with the smallest z-statistic.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_ldistance.html">select_ldistance</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">selection</span><span class="op">$</span><span class="va">recommendation</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GEV"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_lmom_diagram.html">plot_lmom_diagram</a></span><span class="op">(</span><span class="va">selection</span><span class="op">)</span></span></code></pre></div>
<p><img src="stationary-ffa_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><strong>Recommendation</strong>: Use the generalized extreme value
(GEV) distribution.</p>
<p><strong>Note</strong>: For information about the other distributions,
see the <code>selection$metrics</code> item.</p>
<p>You can find more information about the probability distributions
supported by the framework <a href="https://rileywheadon.github.io/ffa-framework/articles/probability-distributions.html" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="parameter-estimation">Parameter Estimation<a class="anchor" aria-label="anchor" href="#parameter-estimation"></a>
</h2>
<p>The <code>ffaframework</code> package provides three methods for
parameter estimation. See <a href="https://rileywheadon.github.io/ffa-framework/articles/parameter-estimation.html" class="external-link">here</a>
for more information.</p>
<ul>
<li>
<code>fit_lmoments</code>: L-moments parameter estimation.</li>
<li>
<code>fit_mle</code>: Maximum likelihood parameter estimation.</li>
<li>
<code>fit_gmle</code>: Generalized maximum likelihood parameter
estimation.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_lmoments.html">fit_lmoments</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="st">"GEV"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">params</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1600.219872  616.666030    0.120747</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_sffa_fit.html">plot_sffa_fit</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="stationary-ffa_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><strong>Conclusion</strong>: The GEV distribution with
<code>location = 1600</code>, <code>scale = 616</code>, and
<code>shape = 0.12</code> will be used.</p>
</div>
<div class="section level2">
<h2 id="uncertainty-quantification">Uncertainty Quantification<a class="anchor" aria-label="anchor" href="#uncertainty-quantification"></a>
</h2>
<p>Once a probability distribution is fitted, return levels (design
events) can be readily estimated. However, point estimates alone can be
misleading –it is more informative to report confidence intervals to
reflect estimation uncertainty. The <code>uncertainty_bootstrap</code>
function performs uncertainty quantification using the parametric
bootstrap method. It requires three arguments:</p>
<ul>
<li>
<code>data</code>: A vector of annual maximum series data.</li>
<li>
<code>model</code>: A three-letter code for a probability
distribution (ex. <code>"GEV"</code>).</li>
<li>
<code>method</code>: A parameter estimation method. Must be
<code>"L-moments"</code>, <code>"MLE"</code>, or
<code>"GMLE"</code>.</li>
</ul>
<p>By default, return levels are computed 2-, 5-, 10-, 20-, 50-, and
100- year return periods.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uncertainty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uncertainty_bootstrap.html">uncertainty_bootstrap</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="st">"GEV"</span>, <span class="st">"L-moments"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_sffa_estimates.html">plot_sffa_estimates</a></span><span class="op">(</span><span class="va">fit</span>, ci <span class="op">=</span> <span class="va">uncertainty</span><span class="op">$</span><span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<p><img src="stationary-ffa_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><strong>Example Conclusion</strong>: Every 10 years, we can expect a
flood of roughly <span class="math inline">\(3{\small,}200\text{m}^3/\text{s}\)</span> or
greater.</p>
</div>
<div class="section level2">
<h2 id="model-assessment">Model Assessment<a class="anchor" aria-label="anchor" href="#model-assessment"></a>
</h2>
<p>Model performance is assessed using <code>model_assessment</code>,
which reports a collection of assessment statistics about the flood
frequency analysis. <code>plot_sffa_assessment</code> compares the data
(the “empirical quantiles”) and the predictions of the parametric model
at the plotting positions (the “theoretical quantiles”). The black line
represents a perfect 1:1 correspondence between the model and the
data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_assessment.html">model_assessment</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">max</span>, <span class="st">"GEV"</span>, <span class="st">"L-moments"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_sffa_assessment.html">plot_sffa_assessment</a></span><span class="op">(</span><span class="va">assessment</span><span class="op">)</span></span></code></pre></div>
<p><img src="stationary-ffa_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><strong>Conclusion</strong>: The parametric model generally matches
the plotting positions. The model slightly underestimates the data from
<span class="math inline">\(3{\small,}500\text{m}^3/\text{s}\)</span> to
<span class="math inline">\(5{\small,}000\text{m}^3/\text{s}\)</span>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riley Wheadon, Cuauhtémoc Vidrio-Sahagún, Alain Pietroniro, Jianxun He, Environment and Climate Change Canada (ECCC).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
