test_that("Test ams-decomposition.R on data set #1.", {

	# Load dataset 
	df <- load_data("Application_1.csv", clean = FALSE)

	# Test decomposition scenario (1)
	data <- ams.decomposition(df, 1)

	expect_equal(data, c(
		1670.0000, 3088.8372, 2757.6744, 2076.5116, 2485.3488, 1464.1860, 1023.0233, 2491.8605,
		1470.6977,  912.5349, 1858.3721, 1537.2093, 1886.0465, 1454.8837, 2213.7209, 2182.5581,
		1131.3953, 1760.2326,  307.0698,       NaN,       NaN,       NaN,       NaN,       NaN,
		      NaN, 1030.9302, 1219.7674, 1608.6047, 1947.4419, 1666.2791, 2045.1163, 4773.9535,
		 913.7907, 1591.6279, 1960.4651, 3609.3023,  988.1395, 1526.9767, 1755.8140, 2384.6512,
		1783.4884, 5392.3256, 2181.1628, 1670.0000, 1108.8372, 2217.6744, 1666.5116, 2755.3488,
		1034.1860, 1493.0233, 1531.8605, 1540.6977, 3449.5349, 1678.3721, 1567.2093, 1226.0465,
		2934.8837, 1463.7209, 4402.5581, 3301.3953, 1770.2326, 2449.0698, 1717.9070, 1556.7442,
		2265.5814, 2214.4186, 2153.2558, 4112.0930, 1160.9302, 3339.7674, 1468.6047, 1307.4419,
		1366.2791, 4315.1163, 1953.9535, 1492.7907, 2231.6279, 2600.4651, 1779.3023,  928.1395,
		 825.9767, 1545.8140, 2064.6512, 2473.4884, 2782.3256, 1511.1628, 2000.0000, 1408.8372,
		2477.6744, 1026.5116, 1265.3488, 1694.1860, 1903.0233, 1051.8605, 2180.6977, 1389.5349,
		1348.3721,  793.2093, 3696.0465, 3014.8837, 2063.7209, 1252.5581,  901.3953, 1100.2326,
		2179.0698, 1737.9070, 2586.7442, 3775.5814
	), tol = 1e-4)

	# Test decomposition scenario (2)
	data <- ams.decomposition(df, 2)

	expect_equal(data, c(
	 	1670.0000, 3088.9238, 2758.5250, 2079.8749, 2488.1588, 1472.9029, 1036.1699, 2496.7165,
    	1484.5490,  933.2050, 1871.7169, 1555.4553, 1901.6916, 1477.4863, 2227.3000, 2197.5644,
    	1164.3505, 1784.4400,  359.0063,       NaN,       NaN,       NaN,       NaN,       NaN,
    	      NaN, 1084.4701, 1270.4903, 1650.7523, 1981.6516, 1709.7934, 2078.7822, 4724.6502,
    	 985.5665, 1643.3908, 2001.3199, 3594.2013, 1065.9215, 1587.1474, 1808.9690, 2414.9745,
    	1838.2406, 5302.8152, 2222.1228, 1733.4772, 1197.9484, 2259.8209, 1734.3751, 2774.5652,
    	1134.5196, 1573.3994, 1611.9032, 1621.8226, 3435.5567, 1755.4191, 1651.4652, 1329.9899,
    	2947.8320, 1558.1130, 4333.5683, 3294.0925, 1851.5427, 2491.7002, 1804.8927, 1654.8257,
    	2321.4775, 2274.3300, 2217.9068, 4051.7557, 1292.0847, 3328.7735, 1582.7562, 1434.0488,
    	1490.5020, 4235.6153, 2039.9426, 1612.7868, 2299.7013, 2642.3821, 1882.5277, 1096.3623,
    	1003.9116, 1670.6081, 2150.6310, 2528.3731, 2813.3312, 1644.4032, 2095.0725, 1553.3355,
    	2535.2454, 1206.0224, 1426.5302, 1820.4109, 2012.5156, 1236.5304, 2267.9533, 1547.8542,
    	1511.8969, 1008.4991, 3648.3256, 3029.4867, 2166.9058, 1432.7912, 1116.4896, 1298.2427,
    	2274.8704, 1877.4146, 2644.2455, 3716.0488
	), tol = 1e-4)

	# Test decomposition scenario (3)
	data <- ams.decomposition(df, 3)

	expect_equal(data, c(
    	1670.0000, 3087.7343, 2756.1258, 2076.2101, 2483.3330, 1466.7036, 1028.6490, 2488.2982,
    	1474.6627,  921.9254, 1859.5145, 1541.9279, 1887.0894, 1461.4965, 2210.4513, 2179.5149,
    	1144.5595, 1763.7873,  336.2973,       NaN,       NaN,       NaN,       NaN,       NaN,
    	      NaN, 1053.7491, 1238.7328, 1618.1473, 1948.1802, 1674.8977, 2043.0858, 4690.5229,
    	 946.4030, 1603.7617, 1960.9320, 3554.5094, 1022.1269, 1542.8160, 1763.7609, 2369.3997,
    	1790.7824, 5258.8885, 2172.9163, 1682.4572, 1145.0187, 2207.3053, 1679.9521, 2720.6105,
    	1076.8972, 1515.3340, 1552.7715, 1561.5817, 3377.2622, 1693.1639, 1587.9127, 1264.7475,
    	2884.4034, 1491.0462, 4270.5988, 3228.1142, 1781.7129, 2422.0332, 1732.7767, 1581.3103,
    	2248.2380, 2199.9169, 2142.2995, 3979.0174, 1212.3123, 3252.4048, 1501.4409, 1351.3106,
    	1406.8060, 4157.2309, 1955.3770, 1526.1369, 2213.6385, 2556.1062, 1793.3289, 1004.1317,
    	 910.3647, 1577.6896, 2057.8975, 2435.5861, 2720.2685, 1547.1824, 1998.0200, 1453.7590,
    	2437.3363, 1103.3703, 1323.4427, 1717.3979, 1909.0195, 1129.7428, 2163.1508, 1439.8929,
    	1402.7900,  896.8307, 3543.6782, 2921.9574, 2055.7023, 1318.2701,  999.9359, 1181.2335,
    	2159.9828, 1760.2327, 2528.5712, 3602.9364
	), tol = 1e-4)

})

test_that("Test ams-decomposition.R on data set #2.", {

	# Load dataset 
	df <- load_data("Application_2.csv", clean = FALSE)

	# Test decomposition scenario (1)
	data <- ams.decomposition(df, 1)

	expect_equal(data, c(
		2350.0000, 1693.8571, 1757.7143, 1511.5714, 2245.4286, 2709.2857, 2613.1429, 2067.0000,
   	    1800.8571, 1664.7143, 2718.5714, 1602.4286, 1716.2857, 1280.1429, 2514.0000, 2137.8571,
   	    1164.7143, 1995.5714, 2609.4286, 2843.2857, 3817.1429, 2751.0000, 2894.8571, 2828.7143,
   	    2352.5714, 2586.4286, 3250.2857, 2884.1429, 3618.0000, 2731.8571, 2715.7143, 3069.5714,
   	    2633.4286, 3767.2857, 2271.1429, 2295.0000, 3138.8571, 2652.7143, 2996.5714, 3320.4286,
   	    2684.2857, 3158.1429, 2442.0000, 3145.8571, 2309.7143, 1433.5714, 2197.4286, 1781.2857,
   	    1925.1429, 1370.0000, 1522.8571, 1468.7143, 1770.5714, 1994.4286, 2028.2857, 1679.1429,
   	    1487.0000, 1819.8571, 1797.7143, 1726.5714, 1579.4286, 1799.2857, 1959.1429, 2393.0000,
   	    1679.8571, 1704.7143, 1653.5714, 2168.4286, 2532.2857, 2696.1429, 2300.0000, 2383.8571,
   	    2027.7143, 1484.5714, 2445.4286, 2027.2857, 1925.1429, 2013.0000, 2860.8571, 2134.7143,
   	    2728.5714, 2162.4286, 2486.2857, 2610.1429, 2874.0000, 2737.8571, 2571.7143, 2345.5714,
   	    2429.4286, 2563.2857, 2587.1429
	), tol = 1e-4)

	# Test decomposition scenario (2)
	data <- ams.decomposition(df, 2)

	expect_equal(data, c(
		2813.4050, 2143.4346, 2194.0713, 1929.6489, 2666.0551, 3133.2203, 3025.3017, 2446.3220,
        2154.1557, 1995.7004, 3101.1107, 1897.5136, 2003.7083, 1514.7987, 2842.4878, 2418.5907,
        1328.7355, 2233.0392, 2906.2487, 3159.7217, 4257.4561, 3036.4465, 3192.3968, 3106.9306,
        2541.3663, 2802.9905, 3577.7267, 3134.6369, 4007.0443, 2931.2158, 2900.4317, 3323.6484,
        2775.6249, 4176.5924, 2295.3796, 2309.2250, 3368.9476, 2735.9136, 3167.9017, 3580.5469,
        2736.8922, 3351.5533, 2385.6248, 3317.2562, 2172.3263,  953.8215, 1979.5807, 1379.5749,
        1555.7068,  745.1054,  931.6737,  823.3084, 1230.2914, 1530.1035, 1554.2839, 1007.5019,
         687.1923, 1158.5575, 1094.3628,  953.1624,  690.6267, 1001.6999, 1223.2172, 1889.2817,
         707.3082,  711.2738,  589.5626, 1411.3428, 1994.8427, 2249.1880, 1543.8837, 1659.5495,
        1003.5240,    1.0000, 1680.0143,  890.1296,  663.3045,  784.3221, 2335.5343,  932.0458,
        2032.6303,  903.9275, 1499.0890, 1710.3928, 2208.8064, 1903.8226, 1529.3654, 1020.1221,
        1154.0914, 1398.6924, 1410.7778
	), tol = 1e-4)

	# Test decomposition scenario (3)
	data <- ams.decomposition(df, 3)

	expect_equal(data, c(
    	2350.0000, 1690.5773, 1751.8151, 1498.6257, 2244.2546, 2720.6664, 2623.6603, 2057.9098,
    	1778.4079, 1632.3696, 2742.5110, 1558.5143, 1675.9824, 1203.3399, 2531.5882, 2123.7011,
    	1057.6112, 1964.9736, 2642.8434, 2905.4713, 4000.7547, 2808.7792, 2975.1269, 2903.7819,
    	2360.5864, 2631.2786, 3405.5050, 2983.9391, 3852.6961, 2812.1794, 2796.2245, 3224.3505,
    	2703.2607, 4085.2924, 2264.9610, 2294.1459, 3341.3114, 2740.9865, 3176.4913, 3592.6177,
    	2790.3695, 3402.1754, 2483.9793, 3401.6785, 2313.1509, 1156.2967, 2164.0203, 1605.5847,
    	1794.6532, 1036.3875, 1236.3684, 1153.7763, 1564.7163, 1872.6402, 1917.1690, 1417.8397,
    	1135.7370, 1607.3004, 1569.6501, 1459.5322, 1235.2946, 1554.4112, 1788.5541, 2441.5519,
    	1353.6302, 1384.0578, 1296.9850, 2094.7278, 2667.5992, 2931.7574, 2300.8066, 2436.7264,
    	1855.6792,  955.8431, 2542.9158, 1842.9217, 1665.6547, 1810.0798, 3269.1481, 2012.9803,
    	3054.8711, 2056.7241, 2635.0712, 2862.6052, 3350.6030, 3109.6775, 2807.9488, 2387.0387,
    	2547.5671, 2807.5875, 2859.2859
 	), tol = 1e-4)

})

test_that("Test ams-decomposition.R on data set #3.1.", {

	# Load dataset 
	df <- load_data("Application_3.1.csv", clean = FALSE)

	# Test decomposition scenario (1)
	data <- ams.decomposition(df, 1)

	expect_equal(data, c(
    	314.0000,  230.4882,  264.9765,  175.4647,  233.9529,  216.4412,  238.9294,  312.4176,
    	177.9059,  349.3941,  189.8823,  253.3706,  176.8588,  215.3470,  383.8353,  174.3235,
    	219.8117,  138.3000,  229.7882,  298.2764,  224.7647,  273.2529,  197.7411,  290.2294,
    	322.7176,  281.2058,  209.6941,  232.1823,  161.6705,  234.1588,  192.6470,  219.1352,
    	141.6235,  182.1117,  225.5999,  175.0882,  143.5764,  222.0646,  185.5529,  311.0411,
    	140.5293,  306.0176,  263.5058,  175.9940,  281.4823,  307.9705,  268.4587,  279.9470,
    	175.4352,  214.9234,  236.4117,  206.8999,  291.3882,  209.8764,  209.3646,  272.8529,
    	316.3411,  252.8293,  303.3176,  219.8058,  232.2940,  184.7823,  229.2705,  341.7587,
    	246.2470,  348.7352,  176.2234,  223.7117,  240.1999,  222.6881,  184.1764,  224.6646,
    	262.1528,  227.6411,  191.1293,  256.6175,  197.1058,  350.5940,  184.0822,  282.5705,
    	247.0587,  278.5469,  282.0352,  171.5234,  169.0116,  188.4999,  304.9881,  273.4763,
    	255.9646,  176.4528,  248.9410,  197.4293,  209.9175,  271.4057,  209.8940,  208.3822,
    	213.8704,  215.3587,  345.8469,  211.3351,  191.8234,  187.3116,  228.7998,  382.2881,
    	516.7763,  229.2645,  202.7528,  159.2410,       NaN,  252.2175
	), tol = 1e-4)

	# Test decomposition scenario (2)
	data <- ams.decomposition(df, 2)

	expect_equal(data, c(
    	314.0000,  230.0031,  264.0181,  173.9801,  232.0139,  214.0017,  236.0250,  309.1183,
    	173.9469,  345.2087,  184.9528,  248.0690,  170.9140,  208.9930,  377.4031,  166.8820,
    	211.9998,  129.7563,  221.0281,  289.2554,  215.0102,  263.1869,  186.9036,  279.2691,
    	311.4152,  269.2489,  196.9314,  219.0327,  147.6861,  220.0402,  177.8211,  203.9562,
    	125.5177,  165.7337,  208.9817,  157.6684,  125.4570,  203.9476,  166.6997,  292.5465,
    	120.3612,  286.5316,  243.2279,  154.5694,  260.3701,  286.5839,  246.2740,  257.3707,
    	151.4936,  190.8186,  211.9994,  181.7305,  266.4928,  183.7385,  182.7240,  246.3281,
    	289.7576,  225.1296,  275.6421,  190.7812,  202.9042,  154.3872,  198.8573,  312.0974,
    	215.0330,  318.2013,  143.2085,  190.7512,  206.9392,  188.7194,  149.2340,  189.7237,
    	227.1895,  191.7415,  154.2549,  220.1049,  159.3016,  314.3717,  145.0902,  244.4453,
    	207.9425,  239.3852,  242.4335,  129.8110,  126.7519,  146.0223,  263.7743,  231.2912,
    	213.0144,  131.7552,  204.8874,  152.0488,  164.2336,  226.2293,  163.2000,  161.1577,
    	166.2337,  167.2427,  299.4919,  162.1391,  141.7758,  136.6739,  178.4019,  334.1904,
    	470.6836,  177.3654,  149.8514,  105.0050,       NaN,  198.7470
	), tol = 1e-4)

	# Test decomposition scenario (3)
	data <- ams.decomposition(df, 3)

	expect_equal(data, c(
    	314.0000,  230.4856,  264.9943,  175.4011,  233.9469,  216.4041,  238.9304,  312.5922,
    	177.7425,  349.7310,  189.7185,  253.4260,  176.6093,  215.2456,  384.5231,  173.9984,
    	219.7109,  137.7241,  229.7355,  298.6612,  224.6720,  273.5005,  197.4377,  290.6331,
    	323.4034,  281.5685,  209.4405,  232.1249,  160.9407,  234.1166,  192.1802,  218.9318,
    	140.5701,  181.4795,  225.4514,  174.3335,  142.4137,  221.8583,  184.8682,  312.0060,
    	139.1942,  306.9624,  263.8649,  175.0777,  282.1288,  309.0390,  268.9304,  280.6136,
    	174.4014,  214.5294,  236.3769,  206.3494,  292.3306,  209.3579,  208.8267,  273.5014,
    	317.8364,  253.1105,  304.6082,  219.4285,  232.1674,  183.6583,  229.0752,  343.9952,
    	246.4186,  351.2002,  174.8110,  223.3721,  240.2410,  222.3138,  182.8680,  224.3275,
    	262.7412,  227.3692,  189.9217,  257.0878,  196.0214,  353.5756,  182.6178,  283.7749,
    	247.2969,  279.6701,  283.2715,  169.6017,  166.9931,  187.0301,  306.9702,  274.5323,
    	256.4990,  174.5400,  249.2687,  196.1344,  209.0067,  272.4701,  208.9619,  207.3900,
    	213.0506,  214.5802,  349.5076,  210.4015,  190.2009,  185.5137,  228.4573,  387.4499,
    	526.8647,  228.9286,  201.4334,  156.2844,       NaN,  252.7417
	), tol = 1e-4)

})

test_that("Test ams-decomposition.R on data set #3.2.", {

	# Load dataset 
	df <- load_data("Application_3.2.csv", clean = FALSE)

	# Test decomposition scenario (1)
	data <- ams.decomposition(df, 1)

	expect_equal(data, c(
         62.9000,   74.3630,   78.7259,   34.6889,   61.7519,   65.0149,   52.9778,   45.2408,
         44.8038,   82.8668,   84.7297,   73.4927,   86.4557,   66.2187,   64.5816,   58.8446,
         58.4076,   50.3706,   63.5335,   44.3965,   63.7595,   33.1225,   50.1854,   69.3484,
         61.0114,   94.2744,   81.9373,   91.2003,       NaN,       NaN,       NaN,       NaN,
             NaN,       NaN,   57.9411,   70.8041,   58.7671,   50.7300,   79.7930,   44.2560,
         48.0190,   67.9819,   47.4449,   54.4079,   87.9709,   79.9338,   67.8968,   53.2598,
         65.0228,  100.2857,   40.4487,  101.0117,   86.0747,   60.7376,   34.5006,   51.3636,
         85.1266,  110.1895,   56.0525,   83.9155,   66.9785,   56.9414,   56.5044,   71.0674,
         66.9304,   48.2933,   88.8563,  122.8193,   55.9823,   47.2452,   49.4082,   37.7712,
    	113.1341,   38.2971,   82.5601,   42.5231,   97.5860,   43.2490,   50.8120,   70.2750,
        150.0379,   33.3009,   52.9639,   91.6269,   64.8898,   88.3528,   52.8158,   38.0788,
         54.3417,   58.3047,   83.4677,   59.1307,   72.5936,   44.8566,   85.1196
	), tol = 1e-4)

	# Test decomposition scenario (2)
	data <- ams.decomposition(df, 2)

	expect_equal(data, c(
   	     62.9000,   74.4594,   78.7261,   37.4838,   63.1587,   66.4066,   56.0513,   49.8129,
   	     49.9959,   82.1678,   83.6242,   74.5349,   84.8081,   69.0584,   67.9806,   63.8768,
   	     63.8022,   58.2387,   67.9259,   54.7063,   68.4177,   47.7955,   59.6609,   72.5557,
   	     67.2398,   88.6643,   80.7504,   86.4760,       NaN,       NaN,       NaN,       NaN,
   	         NaN,       NaN,   66.9711,   74.3032,   67.7196,   63.4770,   79.3018,   60.4013,
   	     62.5957,   73.1494,   62.6751,   66.3913,   83.3644,   79.3267,   73.4168,   66.3751,
   	     72.1529,   88.9613,   60.7519,   89.0839,   82.1073,   70.5406,   58.8040,   66.5251,
   	     81.5539,   92.4826,   68.9128,   80.9527,   73.7401,   69.5664,   69.4706,   75.5672,
   	     73.9048,   66.3980,   82.7952,   96.2717,   69.7595,   66.4238,   67.3695,   62.9986,
   	     91.8296,   63.4655,   80.1633,   65.2900,   85.6706,   65.7767,   68.6210,   75.6930,
   	    104.1334,   62.6745,   69.6957,   83.2159,   73.9528,   82.0252,   69.9228,   65.0197,
   	     70.5667,   71.9444,   80.2917,   72.3150,   76.7360,   67.8049,   80.7754
	), tol = 1e-4)

	# Test decomposition scenario (3)
	data <- ams.decomposition(df, 3)

	expect_equal(data, c(
    	62.9000,   74.1858,   78.1964,   36.6183,   62.0988,   65.1188,   54.4945,   48.0026,
    	47.9664,   80.1079,   81.3854,   72.0551,   82.2230,   66.1859,   64.9302,   60.6274,
    	60.3917,   54.6209,   64.2493,   50.7521,   64.4619,   43.4812,   55.3403,   68.2524,
    	62.7510,   84.3145,   76.1911,   81.8793,       NaN,       NaN,       NaN,       NaN,
    	    NaN,       NaN,   61.4049,   68.7534,   61.9814,   57.5855,   73.5699,   54.2892,
    	56.4351,   67.0789,   56.3552,   60.0556,   77.2394,   73.0627,   66.9815,   59.7483,
    	65.5588,   82.5994,   53.8220,   82.6014,   75.4377,   63.5984,   51.5834,   59.3886,
    	74.6431,   85.7251,   61.6504,   73.8685,   66.4634,   62.1558,   62.0064,   68.1737,
    	66.4290,   58.7226,   75.4041,   89.1102,   62.0106,   58.5605,   59.4808,   54.9744,
    	84.3670,   55.3640,   72.3739,   57.1433,   77.9201,   57.5595,   60.4259,   67.6132,
    	96.6379,   54.2350,   61.3737,   75.1572,   65.6538,   73.8719,   61.4648,   56.4174,
    	62.0559,   63.4321,   71.9372,   63.7471,   68.2382,   59.0710,   72.3105
	), tol = 1e-4)

})
test_that("Test ams-decomposition.R on data set #3.3.", {

	# Load dataset 
	df <- load_data("Application_3.3.csv", clean = FALSE)

	# Test decomposition scenario (1)
	data <- ams.decomposition(df, 1)

	expect_equal(data, c(
    	45.2427,   47.9388,   39.9348,   51.3309,   42.3270,   43.7230,   93.4191,   38.3152,
    	34.8112,   30.2773,   44.4033,   46.2994,   45.1955,   43.8915,   44.1876,   42.0836,
    	40.2797,   29.0758,   24.3218,   38.6679,   52.0639,   37.2600,   33.5561,   40.5521,
    	45.3482,   33.8442,   55.9403,   49.5364,   41.8324,   48.4285,   37.7245,   34.9206,
    	43.3167,   40.0127,   56.4088,   44.3048,   66.9009,   65.0970,   39.4930,   52.0891,
    	34.5852,   17.6812,   36.1773,   43.6733,   19.4694,   31.8655,   49.5615,   53.3576,
    	32.8536,   46.0497,   63.2458,   27.1418,   62.4379,   60.5339,   45.4300,   30.0261,
    	78.0221,   18.7182,   29.3142,   59.6103,   57.1064,   61.5024,   55.3985,   25.8945,
    	49.8906,   19.6867,   11.1827,   41.3788,   66.3748,   50.5709,   16.9670,   54.8630,
    	27.7591,   43.6552,   61.5512,   71.5473,   34.7433,   50.7394,   48.8355,    7.8315,
    	44.2276,    5.5236,   33.7197,   42.6158,   56.8118,   17.4079,   39.2039,    1.0000,
    	29.8961,   46.4921,   57.5882,   51.9842,   42.9803,   26.5764,   55.4724,   63.4685,
    	51.4645
	), tol = 1e-4)

	# Test decomposition scenario (2)
	data <- ams.decomposition(df, 2)

	expect_equal(data, c(
    	21.3000,   24.6139,   17.4532,   29.0331,   21.0782,   22.9968,   68.9938,   19.2844,
    	16.7954,   13.4729,   26.3638,   28.4833,   28.0232,   27.4091,   28.1220,   26.8750,
    	25.8991,   17.5310,   14.3947,   26.0385,   36.6810,   25.8754,   23.5681,   29.1709,
    	33.0488,   25.1406,   41.2544,   37.0097,   31.9553,   36.8296,   29.8472,   28.3225,
    	34.2790,   32.4108,   43.4152,   35.8173,   50.5245,   49.5171,   33.6350,   41.7360,
    	31.2071,   21.2442,   32.7848,   37.5477,   23.4902,   31.1198,   41.6847,   44.0678,
    	32.5638,   40.2934,   50.1256,   30.2150,   49.9193,   49.0009,   40.9617,   32.8972,
    	58.6711,   27.4498,   33.2897,   49.2505,   48.0809,   50.4509,   47.4681,   32.7810,
    	44.9811,   30.1958,   26.2840,   41.2718,   53.5195,   46.0202,   30.1627,   48.3131,
    	35.7201,   43.3247,   51.7428,   56.4157,   39.7080,   47.1131,   46.3767,   28.2186,
    	44.5806,   27.6973,   40.2576,   44.2767,   50.5242,   33.7560,   43.2201,   27.2297,
    	39.5894,   46.6627,   51.3675,   49.1440,   45.5600,   39.0176,   50.8317,   54.1192,
    	49.3988
	), tol = 1e-4)

	# Test decomposition scenario (3)
	data <- ams.decomposition(df, 3)

	expect_equal(data, c(
    	23.2789,   25.9098,   18.0413,   29.0514,   20.3843,   21.7016,   67.8552,   16.7158,
    	13.5834,    9.5987,   22.2540,   23.9005,   22.9088,   21.7672,   22.0079,   20.2289,
    	18.7366,    9.5503,    5.8004,   17.5027,   28.2102,   16.4585,   13.6092,   19.0896,
    	22.7786,   14.0362,   30.6956,   25.8378,   20.1134,   24.9352,   17.1548,   15.1785,
    	21.1924,   18.8634,   30.3182,   21.8652,   37.3429,   35.9739,   18.5965,   27.0278,
    	15.3835,    4.3282,   16.5103,   21.3871,    5.8773,   13.8748,   25.0843,   27.4237,
    	14.6521,   22.8220,   33.3074,   11.3335,   32.6298,   31.4036,   22.3786,   13.3126,
    	41.3698,    6.8747,   13.0680,   30.4136,   28.9255,   31.3399,   27.8559,   11.4450,
    	24.7239,    8.1809,    3.6505,   20.0527,   33.4457,   24.9527,    7.1690,   27.1499,
    	12.9768,   21.2612,   30.4661,   35.5127,   16.7264,   24.8240,   23.8437,    3.3971,
    	21.5242,    2.4802,   16.3783,   20.7277,   27.5825,    8.6316,   19.1016,    1.0000,
    	14.7358,   22.5460,   27.7024,   25.0676,   20.8992,   13.3939,   26.5799,   30.1625,
    	24.7116
   	), tol = 1e-4)

})

