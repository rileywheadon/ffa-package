<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Parametric Bootstrap Uncertainty Quantification — uncertainty_bootstrap • ffaframework</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parametric Bootstrap Uncertainty Quantification — uncertainty_bootstrap"><meta name="description" content="Computes return level estimates and confidence intervals at the specified return
periods (defaults to 2, 5, 10, 20, 50, and 100 years) using the parametric bootstrap.
This function supports many probability models and parameter estimation methods.
For NS-FFA: To perform uncertainty quantification for a nonstationary model,
include the observation years (ns_years), the nonstationary model structure
(ns_structure), and a list of years at which to compute the return level estimates
and confidence intervals (ns_slices)."><meta property="og:description" content="Computes return level estimates and confidence intervals at the specified return
periods (defaults to 2, 5, 10, 20, 50, and 100 years) using the parametric bootstrap.
This function supports many probability models and parameter estimation methods.
For NS-FFA: To perform uncertainty quantification for a nonstationary model,
include the observation years (ns_years), the nonstationary model structure
(ns_structure), and a list of years at which to compute the return level estimates
and confidence intervals (ns_slices)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ffaframework</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/trend-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/trend-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/stationary-ffa.html">Stationary FFA</a></li>
    <li><a class="dropdown-item" href="../articles/non-stationary-ffa.html">Nonstationary FFA</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-wiki" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Wiki</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-wiki"><li><h6 class="dropdown-header" data-toc-skip>EDA</h6></li>
    <li><a class="dropdown-item" href="../articles/eda-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eda-change-points.html">Change Points</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-mean.html">Trends in AMS Mean</a></li>
    <li><a class="dropdown-item" href="../articles/eda-trend-ams-variability.html">Trends in AMS Variability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>FFA</h6></li>
    <li><a class="dropdown-item" href="../articles/ffa-introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-probability-distributions.html">Probability Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-selection.html">Model Selection</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-estimation.html">Parameter Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-uncertainty-quantification.html">Uncertainty Quantification</a></li>
    <li><a class="dropdown-item" href="../articles/ffa-model-assessment.html">Model Assessment</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/matlab-version.html">MATLAB Version</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rileywheadon/ffa-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parametric Bootstrap Uncertainty Quantification</h1>
      <small class="dont-index">Source: <a href="https://github.com/rileywheadon/ffa-package/blob/master/R/uncertainty-bootstrap.R" class="external-link"><code>R/uncertainty-bootstrap.R</code></a></small>
      <div class="d-none name"><code>uncertainty_bootstrap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes return level estimates and confidence intervals at the specified return
periods (defaults to 2, 5, 10, 20, 50, and 100 years) using the parametric bootstrap.
This function supports many probability models and parameter estimation methods.</p>
<p><strong>For NS-FFA</strong>: To perform uncertainty quantification for a nonstationary model,
include the observation years (<code>ns_years</code>), the nonstationary model structure
(<code>ns_structure</code>), and a list of years at which to compute the return level estimates
and confidence intervals (<code>ns_slices</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">uncertainty_bootstrap</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">distribution</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ns_years <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ns_structure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ns_slices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">10000L</span>,</span>
<span>  periods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Numeric vector of observed annual maximum series values.
Must be strictly positive, finite, and not missing.</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>A three-character code indicating the distribution family.
Must be <code>"GUM"</code>, <code>"NOR"</code>, <code>"LNO"</code>, <code>"GEV"</code>, <code>"GLO"</code>, <code>"GNO"</code>, <code>"PE3"</code>, <code>"LP3"</code>,
or <code>"WEI"</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character scalar specifying the estimation method.
Must be <code>"L-moments"</code>, <code>"MLE"</code>, or <code>"GMLE"</code>.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>Numeric vector of length 2. Specifies the parameters of the
Beta prior for the shape parameter \(\kappa\).</p></dd>


<dt id="arg-ns-years">ns_years<a class="anchor" aria-label="anchor" href="#arg-ns-years"></a></dt>
<dd><p>For NS-FFA only: Numeric vector of observation years corresponding
to <code>data</code>. Must be the same length as <code>data</code> and strictly increasing.</p></dd>


<dt id="arg-ns-structure">ns_structure<a class="anchor" aria-label="anchor" href="#arg-ns-structure"></a></dt>
<dd><p>For NS-FFA only: Named list indicating which distribution
parameters are modeled as nonstationary. Must contain two logical scalars:</p><ul><li><p><code>location</code>: If <code>TRUE</code>, the location parameter has a linear temporal trend.</p></li>
<li><p><code>scale</code>: If <code>TRUE</code>, the scale parameter has a linear temporal trend.</p></li>
</ul></dd>


<dt id="arg-ns-slices">ns_slices<a class="anchor" aria-label="anchor" href="#arg-ns-slices"></a></dt>
<dd><p>For NS-FFA only: Numeric vector specifying the years at which to
evaluate the return levels confidence intervals of a nonstationary probability
distribution. <code>ns_slices</code> do not have to be elements of the <code>ns_years</code> argument.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric scalar in \([0.01, 0.1]\). The significance
level for confidence intervals or hypothesis tests. Default is 0.05.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Integer scalar. The number of bootstrap samples. Default is 10000.</p></dd>


<dt id="arg-periods">periods<a class="anchor" aria-label="anchor" href="#arg-periods"></a></dt>
<dd><p>Numeric vector used to set the return periods for FFA.
All entries must be greater than or equal to 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following six items:</p><ul><li><p><code>method</code>: "Bootstrap"</p></li>
<li><p><code>distribution</code>: The <code>distribution</code> argument.</p></li>
<li><p><code>params</code>: The fitted parameters.</p></li>
<li><p><code>ns_structure</code>: The <code>ns_structure</code> argument, if given.</p></li>
<li><p><code>ns_slices</code>: The <code>ns_slices</code> argument, if given.</p></li>
<li><p><code>ci</code>: A dataframe containing confidence intervals (S-FFA only)</p></li>
<li><p><code>ci_list</code>: A list of dataframes containing confidence intervals (NS-FFA only).</p></li>
</ul><p>The dataframe(s) in <code>ci</code> and <code>ci_list</code> have four columns:</p><ul><li><p><code>estimates</code>: Estimated quantiles for each return period.</p></li>
<li><p><code>lower</code>: Lower bound of the confidence interval for each return period.</p></li>
<li><p><code>upper</code>: Upper bound of the confidence interval for each return period.</p></li>
<li><p><code>periods</code>: The <code>periods</code> argument.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Bootstrap samples are obtained from the fitted distribution via inverse transform
sampling. For each bootstrapped sample, the parameters are re-estimated based on the
<code>method</code> argument. Then, the bootstrapped parameters are used to compute a new set of
bootstrapped quantiles. Confidence intervals are obtained from the empirical
nonexceedance probabilities of the bootstrapped quantiles.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The parametric bootstrap is known to give unreasonably wide confidence intervals
for small datasets. If this method yields a confidence interval that is at least
5 times greater than the magnitude of the return levels, it will return an error
and recommend <code><a href="uncertainty_rfpl.html">uncertainty_rfpl()</a></code> or <code><a href="uncertainty_rfgpl.html">uncertainty_rfgpl()</a></code> as alternatives.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vidrio-Sahagún, C.T., He, J. Enhanced profile likelihood method for the nonstationary
hydrological frequency analysis, Advances in Water Resources 161, 10451 (2022).
<a href="https://doi.org/10.1016/j.advwatres.2022.104151" class="external-link">doi:10.1016/j.advwatres.2022.104151</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fit_lmoments.html">fit_lmoments()</a></code>, <code><a href="fit_mle.html">fit_mle()</a></code>, <code><a href="fit_gmle.html">fit_gmle()</a></code>, <code><a href="utils_sample_lmoments.html">utils_sample_lmoments()</a></code>
<code><a href="utils_quantiles.html">utils_quantiles()</a></code>, <code><a href="plot_sffa_estimates.html">plot_sffa_estimates()</a></code>, <code><a href="plot_nsffa_estimates.html">plot_nsffa_estimates()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">uncertainty_bootstrap</span><span class="op">(</span><span class="va">data</span>, <span class="st">"WEI"</span>, <span class="st">"L-moments"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Bootstrap"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WEI"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $params</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 79.289610 24.235689  2.072522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ns_structure</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ns_slices</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   periods estimates     lower    upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       2  99.59695  97.19585 102.0640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       5 109.78095 106.85013 112.7648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      10 115.53275 111.92003 119.3044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      20 120.43962 115.92648 125.2442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      50 126.09451 120.30734 132.4924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     100 129.92731 123.15385 137.6791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riley Wheadon, Cuauhtémoc Vidrio-Sahagún, Alain Pietroniro, Jianxun He, Environment and Climate Change Canada (ECCC).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

