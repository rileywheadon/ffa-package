% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pettitt-plot.R
\name{pettitt.plot}
\alias{pettitt.plot}
\title{Plot Results from the Pettitt Change‐Point Test}
\usage{
pettitt.plot(df, results, show_trend = TRUE)
}
\arguments{
\item{df}{A data frame containing at least the following columns:
\describe{
\item{\code{year}}{Numeric or integer vector of observation years.}
\item{\code{max}}{Numeric vector of observed annual maxima (AMS).}
}
The function will add:
\itemize{
\item \code{ut}: Pettitt Ut statistic for each year.
}}

\item{results}{A list of Pettitt test outputs. Generated by \code{\link{pettitt.test}}.}

\item{show_trend}{Logical; if \code{TRUE} (default), overlays a fitted line through the AMS series.}
}
\value{
A \pkg{patchwork} object consisting of two vertically stacked
\pkg{ggplot2} panels:
\itemize{
\item The time series of Ut with dashed horizontal line at +/-\code{k.critical}
and points marking the potential change point.
\item The AMS series with optional trend line, segment means drawn as horizontal
segments, and change‐point markers.
}
}
\description{
Creates a two‐panel visualization of the Mann–Whitney–Pettitt test:
\enumerate{
\item Upper panel: Pettitt Ut statistic over time with its critical threshold
and highlighted potential change point(s).
\item Lower panel: the original annual maximum series (AMS) with optional
trend line and segment‐wise mean estimates, marking the change point.
}
}
\details{
\enumerate{
\item The Ut statistic is plotted as a solid line against year; the critical value
is shown with a dashed red line.
\item If \code{change.index} > 0, that year’s point is highlighted in blue.
\item The lower panel divides the series into one or two segments (pre‐ and
post‐change) and draws their mean flow levels as green horizontal segments.
}
}
\seealso{
\code{\link[ggplot2]{geom_line}},
\code{\link[ggplot2]{geom_hline}},
\code{\link[ggplot2]{geom_segment}}
}
