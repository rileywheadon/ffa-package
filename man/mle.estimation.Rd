% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mle-estimation.R
\name{mle.estimation}
\alias{mle.estimation}
\title{Fit Extreme‐Value Model using Maximum Likelihood}
\usage{
mle.estimation(data, model, years)
}
\arguments{
\item{model}{Character string specifying the distribution code. The first
three letters denote the family: 'GUM', 'NOR', 'LNO', 'GEV',
'GLO', 'GNO', 'PE3', 'LP3', or 'WEI'. A trailing signature of
'10' or '100' indicates a linear trend in location; '11' or '110'
indicates linear trends in both location and scale.}

\item{df}{Dataframe with columns "max", a vector of annual maxima observations,
and "year", a vector of years corresponding to the observations in "max". Any
\code{NaN} values are removed prior to likelihood computation.}
}
\value{
A list with components:
\itemize{
\item params: Numeric vector of estimated parameters.
\item mll   : Maximized log‐likelihood value.
}
}
\description{
Estimates parameters of an extreme‐value distribution (GUM, NOR, LNO, GEV,
GLO, GNO, PE3, LP3, or WEI) with optional linear covariate trends in
location and/or scale by maximizing the log‐likelihood.
Initial values are obtained from L‐moment estimation, and optimization is
performed via nlminb with repeated perturbations if needed.
}
\details{
\enumerate{
\item Removes NaN values from data.
\item Calls lmom.estimation() on cleaned data to obtain initial estimates of
location, scale, and shape (if applicable).
\item Initializes trend parameters to zero if there is a trailing signature.
\item For Weibull models, forces the location estimate to zero to ensure support.
\item Defines an objective function as the negative of likelihood().
\item Runs nlminb() with box constraints on scale (>0) and repeats up to 100
times with random perturbations if convergence returns Inf.
}
}
