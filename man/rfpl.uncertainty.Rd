% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rfpl-uncertainty.R
\name{rfpl.uncertainty}
\alias{rfpl.uncertainty}
\title{Compute Uncertainty via Regula Falsi Profile Likelihood}
\usage{
rfpl.uncertainty(df, model, years = "last", alpha = 0.05, eps = 0.01)
}
\arguments{
\item{model}{Character string specifying the distribution code. The first three
letters denote the family: 'GUM', 'NOR', 'LNO', 'GEV', 'GLO',
'GNO', 'PE3', 'LP3', or 'WEI'. A trailing signature of '10'/'100' indicates
a trend in location. '11'/'110' indicates trends in both location and scale.}

\item{years}{Character string or numeric vector specifying the years at which
to compute the estimates and confidence intervals. Defaults to "last".
\itemize{
\item{\code{"all"} returns estimates for all years in the dataset.}
\item{\code{"first"} returns estimates for first year in the dataset.}
\item{\code{"last"} returns estimates for last year in the dataset.}
\item{Passing a numeric vector to \code{years} allows for custom values.}
}
If the chosen model is stationary, the results will be the same for all years}

\item{alpha}{Numeric significance level for confidence intervals (default 0.05).}

\item{eps}{Numeric tolerance for the Regula Falsi convergence criterion (default 1e-2).}

\item{data}{Numeric vector of observations. NaN values are removed internally.}
}
\value{
A list with components:
\itemize{
\item ci_lower : Numeric vector of lower confidence bounds for each return period.
\item estimates: Numeric vector of profile‐likelihood point estimates (return levels).
\item ci_upper : Numeric vector of upper confidence bounds for each return period.
}
}
\description{
Calculates point estimates and confidence intervals for return levels at
standard return periods (2, 5, 10, 20, 50, 100 years) using profile
likelihood and the Regula Falsi root‐finding method.
}
\details{
\enumerate{
\item Retrieves the quantile function for the specified model via get.distributions().
\item Fits the model by ordinary MLE to obtain parameter estimates and log‐likelihood.
\item Defines an objective function f(yp, pe) based on the chi-squared distribution.
\item Iteratively brackets the root by scaling initial guesses by 0.05 until f changes sign.
\item Uses the Regula Falsi method to solve f(yp, pe) = 0 for each return-period probability.
\item Returns lower and upper confidence bounds at level alpha and the point estimates.
}
}
