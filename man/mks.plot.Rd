% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mks-plot.R
\name{mks.plot}
\alias{mks.plot}
\title{Plot Results from the Mann–Kendall–Sneyers (MKS) Test}
\usage{
mks.plot(data, years, result, show_trend = TRUE)
}
\arguments{
\item{result}{A \code{list} containing the MKS test outputs, generated by \code{\link{mks.test}}.}

\item{show_trend}{Logical; if \code{TRUE} (default), draw a fitted line through the AMS series.}

\item{df}{A \code{data.frame} containing at least the following columns:
\describe{
\item{\code{year}}{Numeric or integer vector of years.}
\item{\code{max}}{Numeric vector of observed annual maxima.}
}
After loading \code{result} into the environment, the function adds:
\itemize{
\item \code{s.progressive}: normalized progressive S‐statistic (numeric).
\item \code{s.regressive}: normalized regressive S‐statistic (numeric).
}}
}
\value{
A \code{patchwork} object stacking two \code{ggplot2} panels vertically:
the test–statistic time series with bounds and change points, and the AMS series
with optional trend.
}
\description{
Constructs a two‐panel visualization of the MKS test:
\enumerate{
\item Upper panel: normalized progressive and regressive Mann–Kendall S‐statistics
over time, with dashed confidence bounds and marked potential trend‐change points.
\item Lower panel: the original annual maximum series (AMS) with optional trend line
and highlighted change points.
}
}
\details{
\itemize{
\item The upper plot uses \code{geom_line()} for S‐statistics, \code{geom_hline()}
for +/-\code{bound}, and \code{geom_point()} for \code{change.df$statistic}.
\item The lower plot marks all AMS points with \code{geom_point()}, overlays a trend line
if \code{show_trend = TRUE}, and highlights change points from \code{change.df}.
\item Both panels share a common color legend, with custom labels.
}
}
