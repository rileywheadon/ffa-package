% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eda-mks-test.R
\name{eda_mks_test}
\alias{eda_mks_test}
\title{Mann–Kendall–Sneyers Test for Change Point Detection}
\usage{
eda_mks_test(data, years, alpha = 0.05, quiet = TRUE)
}
\arguments{
\item{data}{Numeric vector of annual maximum streamflow (AMS) values.
Must be strictly positive, finite, and non-missing.}

\item{years}{Numeric vector of observation years corresponding to \code{data}.
Must be the same length as \code{data} and strictly increasing.}

\item{alpha}{Numeric scalar in \eqn{[0.01, 0.1]}. The significance
level for confidence intervals or hypothesis tests. Default is 0.05.}

\item{quiet}{Logical scalar. If \code{FALSE}, prints a summary of of the statistical
test to the console. Default is \code{TRUE}.}
}
\value{
A list containing the test results, including:
\itemize{
\item \code{data}: The \code{data} argument.
\item \code{years}: The \code{years} argument.
\item \code{s_progressive}: Normalized progressive Mann–Kendall-Sneyers statistics.
\item \code{s_regressive}: Normalized regressive Mann–Kendall-Sneyers statistics.
\item \code{bound}: Critical confidence bound for significance based on \code{alpha}.
\item \code{crossing_df}: Crossing points, including indices, years, statistics, and AMS.
\item \code{change_df}: Subset of \code{crossing.df} with statistically significant crossings.
\item \code{p_value}: Two-sided p-value derived from the maximum crossing statistic.
\item \code{reject}: Logical. If \code{TRUE}, the null hypothesis of no change point is rejected.
\item \code{msg}: Character string summarizing the test result (printed if \code{quiet = FALSE}).
}
}
\description{
Performs the Mann–Kendall–Sneyers (MKS) test to detect the beginning of a monotonic
trend in annual maximum streamflow (AMS) data. The test computes normalized
progressive and regressive Mann–Kendall statistics and identifies statistically
significant crossing points, indicating potential change points in the trend.
}
\details{
The function computes progressive and regressive Mann–Kendall statistics \eqn{S_t},
normalized by their expected values and variances under the null hypothesis. The
crossing points where the difference between these normalized statistics changes
sign are identified using linear interpolation. The significance of detected
crossings is assessed using quantiles of the normal distribution.
}
\examples{
data <- rnorm(n = 100, mean = 100, sd = 10)
years <- seq(from = 1901, to = 2000)
eda_mks_test(data, years)

}
\references{
Sneyers, R. (1990). On the statistical analysis of series of observations.
Technical note No. 143, World Meteorological Organization, Geneva.
}
\seealso{
\link{plot_mks_test}
}
